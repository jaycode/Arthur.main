var app = app || {};

!function() {
    Object.defineProperty(Number.prototype, "fileSize", {
        value: function(a, b, c, d) {
            return (a = a ? [ 1e3, "k", "B" ] : [ 1024, "K", "iB" ], b = Math, c = b.log, d = c(this) / c(a[0]) | 0, 
            this / b.pow(a[0], d)).toFixed(2) + " " + (d ? (a[1] + "MGTPEZY")[--d] + a[2] : "Bytes");
        },
        writable: !1,
        enumerable: !1
    }), app.viewModel = function() {
        self = this, self.project = new app.Project(app.data.project), self.activeDoc = new app.ActiveDoc(app.data.project.active_doc), 
        self.footerInfo = ko.observable("Hover cursor over document to view its coordinates here."), 
        self.loadDoc = function(a) {
            var b = $(a.target).closest("tr").find("td").first().text();
            $("#console").terminal().exec("load_doc " + b);
        }, self.showCursorPosition = function(a, b) {
            for (var c = null, d = $("#doc-pageframe-1").offset().top, e = 0; e < a.pages().length; e++) page = a.pages()[e], 
            b.pageY - d >= page.yRender() && b.pageY - d <= page.yRender() + page.height() && (c = page);
            if (null != c) {
                var f = $(document).width() / 2, g = f - a.maxWidth() / 2, h = b.pageX - g, i = $("#doc-pageframe-" + c.number()).offset().top, j = c.y(), k = j + (b.pageY - i);
                self.footerInfo("page " + c.number() + ", x: " + parseInt(h) + ", y: " + parseInt(k));
            }
        }, self.shrinkConsole = function() {
            $("#console").css("height", 0), $("#main_area").css("padding-bottom", 60);
        }, self.expandConsole = function() {
            $("#console").css("height", app.data.settings.consoleDefaultHeight), $("#main_area").css("padding-bottom", app.data.settings.consoleDefaultHeight + 40);
        }, self.maximizeConsole = function() {
            $("#console").css("height", $(window).height() - 53), $("#main_area").css("padding-bottom", 60);
        }, self.resizeConsole = function() {
            parseFloat($("#console").css("height")) < app.data.settings.consoleDefaultHeight ? self.expandConsole() : self.shrinkConsole();
        };
    }, app.showPage = function(a) {
        $(".page").removeClass("is_active"), $(a).addClass("is_active");
    }, $(document).ready(function() {
        app.connection.first_connection = !0, app.connection.connect(), app.vm = new app.viewModel(), 
        ko.applyBindings(app.vm), app.vm.expandConsole(), jQuery(function(a, b) {
            a("#console").terminal(function(b, c) {
                var d = a.terminal.splitCommand(b);
                return "connect" == d.name ? (null != app.connection.handler && app.connection.disconnect(), 
                app.connection.ran_connect_cmd = !0, app.connection.connect(), !1) : void (app.connection.handler ? app.connection.handler.send(JSON.stringify({
                    method: d.name,
                    params: d.args
                })) : a("#console").terminal().echo("Disconnected from server, run 'connect' to reconnect."));
            }, {
                greetings: "Type 'help' for list of commands.",
                name: "arthur.ai console",
                height: app.data.settings.consoleDefaultHeight,
                prompt: "arthur> ",
                keydown: function(a) {
                    return 82 === a.which && a.ctrlKey ? !0 : 187 === a.which && a.altKey ? (app.vm.maximizeConsole(), 
                    !0) : 189 === a.which && a.altKey ? (app.vm.shrinkConsole(), !0) : 48 === a.which && a.altKey ? (app.vm.expandConsole(), 
                    !0) : void 0;
                }
            });
        });
    });
}(), function() {
    app.connection = {
        handler: null
    }, app.connection.log = function(a) {
        var b = this;
        $("#workspace");
        try {
            var c = JSON.parse(a);
        } catch (d) {
            "SyntaxError" == d.name ? $("#console").terminal().echo(a + "\n") : $("#console").terminal().echo(d.message + "\n");
        }
        "undefined" != typeof c && ("#doc-list" == c.page && b.ran_connect_cmd && 0 == b.first_connection ? $("#console").terminal().echo("Connected to workspace server.\n") : (c.pass_project && (app.vm.project.updateFromData(c.project), 
        app.vm.activeDoc.updateFromData(c.project.active_doc, c.data_fields)), c.pass_docs && ($.fn.dataTable.isDataTable("#doc-list-table") ? table = $("#doc-list-table").DataTable() : $("#doc-list-table").DataTable({
            paging: !0,
            pagingType: "numbers",
            data: c.docs,
            columns: [ {
                title: "Doc Name",
                data: "name"
            }, {
                title: "Labeled",
                data: "num_data_fields_labeled"
            }, {
                title: "Blocks",
                data: "num_data_fields_total"
            }, {
                title: "Filesize",
                type: "natural",
                data: "size",
                render: function(a) {
                    return a.fileSize();
                }
            }, {
                title: "Status",
                data: function(a, b, c, d) {
                    var e = "unprocessed";
                    return a.num_data_fields_labeled > 0 && (e = "labeled"), e;
                }
            }, {
                sortable: !1,
                render: function(a) {
                    return '<a role="button" onclick="app.vm.loadDoc(event);" class="button tiny inline">Load</a>';
                }
            } ]
        })), "undefined" != typeof c.page && app.showPage(c.page), $("#console").terminal().echo(c.message + "\n")), 
        app.connection.first_connection = !1, app.connection.ran_connect_cmd = !1);
    }, app.connection.connect = function() {
        var a = this;
        app.connection.disconnect();
        var b = {
            websocket: 1,
            "xhr-streaming": 1,
            "iframe-eventsource": 1,
            "iframe-htmlfile": 1,
            "xhr-polling": 1,
            "iframe-xhr-polling": 1,
            "jsonp-polling": 1
        };
        app.connection.handler = new SockJS("http://" + window.location.hostname + ":49152/workspace", b), 
        app.connection.handler.onopen = function() {}, app.connection.handler.onmessage = function(b) {
            a.log(b.data);
        }, app.connection.handler.onclose = function() {
            app.connection.handler = null;
        };
    }, app.connection.disconnect = function() {
        null != app.connection.handler && (app.connection.handler.close(), app.connection.handler = null);
    };
}(), function() {
    app.data = {
        settings: {
            consoleDefaultHeight: 200,
            pageVertMargin: 20,
            pageTopOffset: 0,
            blockOffset: 8
        }
    }, app.data.project = {
        name: "risky",
        active_doc: {
            name: "Document.pdf",
            page_infos: [ {
                number: 1,
                width: 600,
                height: 800
            }, {
                number: 2,
                width: 800,
                height: 600
            } ],
            elements: [ {
                features: {
                    x: 100,
                    y: 7,
                    x1: 106,
                    y1: 18,
                    page: 1,
                    size: 10
                },
                text: "T"
            }, {
                features: {
                    x: 110,
                    y: 7,
                    x1: 116,
                    y1: 18,
                    page: 1,
                    size: 10
                },
                text: "e"
            }, {
                features: {
                    x: 120,
                    y: 7,
                    x1: 125,
                    y1: 18,
                    page: 1,
                    size: 10
                },
                text: "s"
            }, {
                features: {
                    x: 130,
                    y: 7,
                    x1: 133,
                    y1: 18,
                    page: 1,
                    size: 10
                },
                text: "t"
            }, {
                features: {
                    x: 10,
                    y: 820,
                    x1: 22,
                    y1: 842,
                    page: 2,
                    size: 20
                },
                text: "T"
            }, {
                features: {
                    x: 20,
                    y: 820,
                    x1: 21,
                    y1: 842,
                    page: 2,
                    size: 20
                },
                text: "e"
            }, {
                features: {
                    x: 30,
                    y: 820,
                    x1: 40,
                    y1: 842,
                    page: 2,
                    size: 20
                },
                text: "s"
            }, {
                features: {
                    x: 40,
                    y: 820,
                    x1: 45,
                    y1: 842,
                    page: 2,
                    size: 20
                },
                text: "t"
            }, {
                features: {
                    x: 50,
                    y: 820,
                    x1: 66,
                    y1: 842,
                    page: 2,
                    size: 20
                },
                text: "2"
            } ]
        },
        docs: [],
        context: "",
        concepts: []
    };
}(), function() {
    function a(a, b) {
        var c = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi, d = /(^[ ]*|[ ]*$)/g, e = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/, f = /^0x[0-9a-f]+$/i, g = /^0/, h = a.toString().replace(d, "") || "", i = b.toString().replace(d, "") || "", j = h.replace(c, "\x00$1\x00").replace(/\0$/, "").replace(/^\0/, "").split("\x00"), k = i.replace(c, "\x00$1\x00").replace(/\0$/, "").replace(/^\0/, "").split("\x00"), l = parseInt(h.match(f), 10) || 1 !== j.length && h.match(e) && Date.parse(h), m = parseInt(i.match(f), 10) || l && i.match(e) && Date.parse(i) || null;
        if (m) {
            if (m > l) return -1;
            if (l > m) return 1;
        }
        for (var n = 0, o = Math.max(j.length, k.length); o > n; n++) {
            var p = !(j[n] || "").match(g) && parseFloat(j[n], 10) || j[n] || 0, q = !(k[n] || "").match(g) && parseFloat(k[n], 10) || k[n] || 0;
            if (isNaN(p) !== isNaN(q)) return isNaN(p) ? 1 : -1;
            if (typeof p != typeof q && (p += "", q += ""), q > p) return -1;
            if (p > q) return 1;
        }
        return 0;
    }
    jQuery.extend(jQuery.fn.dataTableExt.oSort, {
        "natural-asc": function(b, c) {
            return a(b, c);
        },
        "natural-desc": function(b, c) {
            return -1 * a(b, c);
        }
    });
}(), function() {
    app.helpers = app.helpers || {}, app.helpers.view = {}, app.helpers.view.showTip = function() {
        var a = d3.select(d3.event.target).attr("title"), b = 20, c = -20, d = d3.select("body").append("span").classed("tooltip", !0).style("top", d3.event.pageY + b + "px").style("left", d3.event.pageX + c + "px").style("min-width", "90px").style("display", "inline").html(a);
        d.append("span").classed("nub", !0), d.append("span").classed("tap-to-close", !0);
    }, app.helpers.view.hideTip = function() {
        d3.select(".tooltip").remove();
    }, app.helpers.view.showBlockDialog = function() {};
}(), function(a) {
    function b(b) {
        var c = b || window.event, d = [].slice.call(arguments, 1), e = 0, f = 0, g = 0;
        return b = a.event.fix(c), b.type = "mousewheel", c.wheelDelta && (e = c.wheelDelta / 120), 
        c.detail && (e = -c.detail / 3), g = e, void 0 !== c.axis && c.axis === c.HORIZONTAL_AXIS && (g = 0, 
        f = -1 * e), void 0 !== c.wheelDeltaY && (g = c.wheelDeltaY / 120), void 0 !== c.wheelDeltaX && (f = -1 * c.wheelDeltaX / 120), 
        d.unshift(b, e, f, g), (a.event.dispatch || a.event.handle).apply(this, d);
    }
    var c = [ "DOMMouseScroll", "mousewheel" ];
    if (a.event.fixHooks) for (var d = c.length; d; ) a.event.fixHooks[c[--d]] = a.event.mouseHooks;
    a.event.special.mousewheel = {
        setup: function() {
            if (this.addEventListener) for (var a = c.length; a; ) this.addEventListener(c[--a], b, !1); else this.onmousewheel = b;
        },
        teardown: function() {
            if (this.removeEventListener) for (var a = c.length; a; ) this.removeEventListener(c[--a], b, !1); else this.onmousewheel = null;
        }
    }, a.fn.extend({
        mousewheel: function(a) {
            return a ? this.bind("mousewheel", a) : this.trigger("mousewheel");
        },
        unmousewheel: function(a) {
            return this.unbind("mousewheel", a);
        }
    });
}(jQuery), function(a) {
    function b(a) {
        return Object.prototype.toString.call(a).slice(8, -1).toLowerCase();
    }
    function c(a, b) {
        for (var c = []; b > 0; c[--b] = a) ;
        return c.join("");
    }
    var d = function() {
        return d.cache.hasOwnProperty(arguments[0]) || (d.cache[arguments[0]] = d.parse(arguments[0])), 
        d.format.call(null, d.cache[arguments[0]], arguments);
    };
    d.format = function(a, e) {
        var f, g, h, i, j, k, l, m = 1, n = a.length, o = "", p = [];
        for (g = 0; n > g; g++) if (o = b(a[g]), "string" === o) p.push(a[g]); else if ("array" === o) {
            if (i = a[g], i[2]) for (f = e[m], h = 0; h < i[2].length; h++) {
                if (!f.hasOwnProperty(i[2][h])) throw d('[sprintf] property "%s" does not exist', i[2][h]);
                f = f[i[2][h]];
            } else f = i[1] ? e[i[1]] : e[m++];
            if (/[^s]/.test(i[8]) && "number" != b(f)) throw d("[sprintf] expecting number but found %s", b(f));
            switch (i[8]) {
              case "b":
                f = f.toString(2);
                break;

              case "c":
                f = String.fromCharCode(f);
                break;

              case "d":
                f = parseInt(f, 10);
                break;

              case "e":
                f = i[7] ? f.toExponential(i[7]) : f.toExponential();
                break;

              case "f":
                f = i[7] ? parseFloat(f).toFixed(i[7]) : parseFloat(f);
                break;

              case "o":
                f = f.toString(8);
                break;

              case "s":
                f = (f = String(f)) && i[7] ? f.substring(0, i[7]) : f;
                break;

              case "u":
                f >>>= 0;
                break;

              case "x":
                f = f.toString(16);
                break;

              case "X":
                f = f.toString(16).toUpperCase();
            }
            f = /[def]/.test(i[8]) && i[3] && f >= 0 ? "+" + f : f, k = i[4] ? "0" == i[4] ? "0" : i[4].charAt(1) : " ", 
            l = i[6] - String(f).length, j = i[6] ? c(k, l) : "", p.push(i[5] ? f + j : j + f);
        }
        return p.join("");
    }, d.cache = {}, d.parse = function(a) {
        for (var b = a, c = [], d = [], e = 0; b; ) {
            if (null !== (c = /^[^\x25]+/.exec(b))) d.push(c[0]); else if (null !== (c = /^\x25{2}/.exec(b))) d.push("%"); else {
                if (null === (c = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b))) throw "[sprintf] huh?";
                if (c[2]) {
                    e |= 1;
                    var f = [], g = c[2], h = [];
                    if (null === (h = /^([a-z_][a-z_\d]*)/i.exec(g))) throw "[sprintf] huh?";
                    for (f.push(h[1]); "" !== (g = g.substring(h[0].length)); ) if (null !== (h = /^\.([a-z_][a-z_\d]*)/i.exec(g))) f.push(h[1]); else {
                        if (null === (h = /^\[(\d+)\]/.exec(g))) throw "[sprintf] huh?";
                        f.push(h[1]);
                    }
                    c[2] = f;
                } else e |= 2;
                if (3 === e) throw "[sprintf] mixing positional and named placeholders is not (yet) supported";
                d.push(c);
            }
            b = b.substring(c[0].length);
        }
        return d;
    };
    var e = function(a, b, c) {
        return c = b.slice(0), c.splice(0, 0, a), d.apply(null, c);
    };
    a.sprintf = d, a.vsprintf = e;
}("undefined" != typeof exports ? exports : window), function(a, b) {
    "use strict";
    function c(a, b) {
        var c;
        if ("string" == typeof a && "string" == typeof b) return localStorage[a] = b, !0;
        if ("object" == typeof a && "undefined" == typeof b) {
            for (c in a) a.hasOwnProperty(c) && (localStorage[c] = a[c]);
            return !0;
        }
        return !1;
    }
    function d(a, b) {
        var c, d, e;
        if (c = new Date(), c.setTime(c.getTime() + 31536e6), d = "; expires=" + c.toGMTString(), 
        "string" == typeof a && "string" == typeof b) return document.cookie = a + "=" + b + d + "; path=/", 
        !0;
        if ("object" == typeof a && "undefined" == typeof b) {
            for (e in a) a.hasOwnProperty(e) && (document.cookie = e + "=" + a[e] + d + "; path=/");
            return !0;
        }
        return !1;
    }
    function e(a) {
        return localStorage[a];
    }
    function f(a) {
        var b, c, d, e;
        for (b = a + "=", c = document.cookie.split(";"), d = 0; d < c.length; d++) {
            for (e = c[d]; " " === e.charAt(0); ) e = e.substring(1, e.length);
            if (0 === e.indexOf(b)) return e.substring(b.length, e.length);
        }
        return null;
    }
    function g(a) {
        return delete localStorage[a];
    }
    function h(a) {
        return d(a, "", -1);
    }
    function i(a, b) {
        var c = [], d = a.length;
        if (b > d) return [ a ];
        for (var e = 0; d > e; e += b) c.push(a.substring(e, e + b));
        return c;
    }
    function j(b) {
        var c = b ? [ b ] : [], d = 0;
        a.extend(this, {
            get: function() {
                return c;
            },
            rotate: function() {
                return 1 === c.length ? c[0] : (d === c.length - 1 ? d = 0 : ++d, c[d]);
            },
            length: function() {
                return c.length;
            },
            set: function(a) {
                for (var b = c.length; b--; ) if (c[b] === a) return void (d = b);
                this.append(a);
            },
            front: function() {
                return c[d];
            },
            append: function(a) {
                c.push(a);
            }
        });
    }
    function k(b) {
        var c = b ? [ b ] : [];
        a.extend(this, {
            map: function(b) {
                return a.map(c, b);
            },
            size: function() {
                return c.length;
            },
            pop: function() {
                if (0 === c.length) return null;
                var a = c[c.length - 1];
                return c = c.slice(0, c.length - 1), a;
            },
            push: function(a) {
                return c = c.concat([ a ]), a;
            },
            top: function() {
                return c.length > 0 ? c[c.length - 1] : null;
            }
        });
    }
    function l(b, c) {
        var d = !0, e = "";
        "string" == typeof b && "" !== b && (e = b + "_"), e += "commands";
        var f = a.Storage.get(e);
        f = f ? a.parseJSON(f) : [];
        var g = f.length - 1;
        a.extend(this, {
            append: function(b) {
                d && f[f.length - 1] !== b && (f.push(b), c && f.length > c && (f = f.slice(-c)), 
                g = f.length - 1, a.Storage.set(e, a.json_stringify(f)));
            },
            data: function() {
                return f;
            },
            reset: function() {
                g = f.length - 1;
            },
            last: function() {
                return f[length - 1];
            },
            end: function() {
                return g === f.length - 1;
            },
            position: function() {
                return g;
            },
            current: function() {
                return f[g];
            },
            next: function() {
                return g < f.length - 1 && ++g, -1 !== g ? f[g] : void 0;
            },
            previous: function() {
                var a = g;
                return g > 0 && --g, -1 !== a ? f[g] : void 0;
            },
            clear: function() {
                f = [], this.purge();
            },
            enabled: function() {
                return d;
            },
            enable: function() {
                d = !0;
            },
            purge: function() {
                a.Storage.remove(e);
            },
            disable: function() {
                d = !1;
            }
        });
    }
    function m(b) {
        return a("<div>" + a.terminal.strip(b) + "</div>").text().length;
    }
    function n() {
        var a = !1, c = "animation", d = "", e = "Webkit Moz O ms Khtml".split(" "), f = "", g = document.createElement("div");
        if (g.style.animationName && (a = !0), a === !1) for (var h = 0; h < e.length; h++) if (g.style[e[h] + "AnimationName"] !== b) {
            f = e[h], c = f + "Animation", d = "-" + f.toLowerCase() + "-", a = !0;
            break;
        }
        return a;
    }
    function o(a, b) {
        var c = a.replace(/^\s+|\s+$/g, "").split(/(\s+)/), d = a.replace(/^[^\s]+\s*/, "");
        return {
            name: c[0],
            args: b(d),
            rest: d
        };
    }
    function p(b) {
        var c = a(window).scrollTop(), d = c + a(window).height(), e = a(b).offset().top, f = e + a(b).height();
        return f >= c && d >= e;
    }
    function q() {
        var b = a('<div class="terminal"><div class="cmd"><span>&nbsp;</span></div></div>').appendTo("body"), c = b.find("span"), d = {
            width: c.width(),
            height: c.outerHeight()
        };
        return b.remove(), d;
    }
    function r(a) {
        var b = q().width, c = Math.floor(a.width() / b);
        if (u(a)) {
            var d = 20, e = a.innerWidth() - a.width();
            c -= Math.ceil((d - e / 2) / (b - 1));
        }
        return c;
    }
    function s(a) {
        return Math.floor(a.height() / q().height);
    }
    function t() {
        if (window.getSelection || document.getSelection) {
            var a = (window.getSelection || document.getSelection)();
            return a.text ? a.text : a.toString();
        }
        return document.selection ? document.selection.createRange().text : void 0;
    }
    function u(a) {
        return a.get(0).scrollHeight > a.innerHeight();
    }
    a.omap = function(b, c) {
        var d = {};
        return a.each(b, function(a, e) {
            d[a] = c.call(b, a, e);
        }), d;
    };
    var v = "undefined" != typeof window.localStorage;
    a.extend({
        Storage: {
            set: v ? c : d,
            get: v ? e : f,
            remove: v ? g : h
        }
    }), jQuery.fn.extend({
        everyTime: function(a, b, c, d, e) {
            return this.each(function() {
                jQuery.timer.add(this, a, b, c, d, e);
            });
        },
        oneTime: function(a, b, c) {
            return this.each(function() {
                jQuery.timer.add(this, a, b, c, 1);
            });
        },
        stopTime: function(a, b) {
            return this.each(function() {
                jQuery.timer.remove(this, a, b);
            });
        }
    }), jQuery.extend({
        timer: {
            guid: 1,
            global: {},
            regex: /^([0-9]+)\s*(.*s)?$/,
            powers: {
                ms: 1,
                cs: 10,
                ds: 100,
                s: 1e3,
                das: 1e4,
                hs: 1e5,
                ks: 1e6
            },
            timeParse: function(a) {
                if (a === b || null === a) return null;
                var c = this.regex.exec(jQuery.trim(a.toString()));
                if (c[2]) {
                    var d = parseInt(c[1], 10), e = this.powers[c[2]] || 1;
                    return d * e;
                }
                return a;
            },
            add: function(a, b, c, d, e, f) {
                var g = 0;
                if (jQuery.isFunction(c) && (e || (e = d), d = c, c = b), b = jQuery.timer.timeParse(b), 
                !("number" != typeof b || isNaN(b) || 0 >= b)) {
                    e && e.constructor !== Number && (f = !!e, e = 0), e = e || 0, f = f || !1, a.$timers || (a.$timers = {}), 
                    a.$timers[c] || (a.$timers[c] = {}), d.$timerID = d.$timerID || this.guid++;
                    var h = function() {
                        f && h.inProgress || (h.inProgress = !0, (++g > e && 0 !== e || d.call(a, g) === !1) && jQuery.timer.remove(a, c, d), 
                        h.inProgress = !1);
                    };
                    h.$timerID = d.$timerID, a.$timers[c][d.$timerID] || (a.$timers[c][d.$timerID] = window.setInterval(h, b)), 
                    this.global[c] || (this.global[c] = []), this.global[c].push(a);
                }
            },
            remove: function(a, b, c) {
                var d, e = a.$timers;
                if (e) {
                    if (b) {
                        if (e[b]) {
                            if (c) c.$timerID && (window.clearInterval(e[b][c.$timerID]), delete e[b][c.$timerID]); else for (var f in e[b]) e[b].hasOwnProperty(f) && (window.clearInterval(e[b][f]), 
                            delete e[b][f]);
                            for (d in e[b]) if (e[b].hasOwnProperty(d)) break;
                            d || (d = null, delete e[b]);
                        }
                    } else for (var g in e) e.hasOwnProperty(g) && this.remove(a, g, c);
                    for (d in e) if (e.hasOwnProperty(d)) break;
                    d || (a.$timers = null);
                }
            }
        }
    }), /(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) && jQuery(window).one("unload", function() {
        var a = jQuery.timer.global;
        for (var b in a) if (a.hasOwnProperty(b)) for (var c = a[b], d = c.length; --d; ) jQuery.timer.remove(c[d], b);
    }), function(a) {
        if (String.prototype.split.toString().match(/\[native/)) {
            var b, c = String.prototype.split, d = /()??/.exec("")[1] === a;
            return b = function(b, e, f) {
                if ("[object RegExp]" !== Object.prototype.toString.call(e)) return c.call(b, e, f);
                var g, h, i, j, k = [], l = (e.ignoreCase ? "i" : "") + (e.multiline ? "m" : "") + (e.extended ? "x" : "") + (e.sticky ? "y" : ""), m = 0;
                for (e = new RegExp(e.source, l + "g"), b += "", d || (g = new RegExp("^" + e.source + "$(?!\\s)", l)), 
                f = f === a ? -1 >>> 0 : f >>> 0; (h = e.exec(b)) && (i = h.index + h[0].length, 
                !(i > m && (k.push(b.slice(m, h.index)), !d && h.length > 1 && h[0].replace(g, function() {
                    for (var b = 1; b < arguments.length - 2; b++) arguments[b] === a && (h[b] = a);
                }), h.length > 1 && h.index < b.length && Array.prototype.push.apply(k, h.slice(1)), 
                j = h[0].length, m = i, k.length >= f))); ) e.lastIndex === h.index && e.lastIndex++;
                return m === b.length ? (j || !e.test("")) && k.push("") : k.push(b.slice(m)), k.length > f ? k.slice(0, f) : k;
            }, String.prototype.split = function(a, c) {
                return b(this, a, c);
            }, b;
        }
    }(), a.json_stringify = function(c, d) {
        var e, f = "";
        d = d === b ? 1 : d;
        var g = typeof c;
        switch (g) {
          case "function":
            f += c;
            break;

          case "boolean":
            f += c ? "true" : "false";
            break;

          case "object":
            if (null === c) f += "null"; else if (c instanceof Array) {
                f += "[";
                var h = c.length;
                for (e = 0; h - 1 > e; ++e) f += a.json_stringify(c[e], d + 1);
                f += a.json_stringify(c[h - 1], d + 1) + "]";
            } else {
                f += "{";
                for (var i in c) c.hasOwnProperty(i) && (f += '"' + i + '":' + a.json_stringify(c[i], d + 1));
                f += "}";
            }
            break;

          case "string":
            var j = c, k = {
                "\\\\": "\\\\",
                '"': '\\"',
                "/": "\\/",
                "\\n": "\\n",
                "\\r": "\\r",
                "\\t": "\\t"
            };
            for (e in k) k.hasOwnProperty(e) && (j = j.replace(new RegExp(e, "g"), k[e]));
            f += '"' + j + '"';
            break;

          case "number":
            f += String(c);
        }
        return f += d > 1 ? "," : "", 1 === d && (f = f.replace(/,([\]}])/g, "$1")), f.replace(/([\[{]),/g, "$1");
    }, a.fn.cmd = function(c) {
        function d(a) {
            K.toggleClass("inverted");
        }
        function e() {
            w = "(reverse-i-search)`" + B + "': ", N();
        }
        function f() {
            w = v, A = !1, C = null, B = "";
        }
        function g(a) {
            var b, c, d = y.data(), f = d.length;
            if (a && C > 0 && (f -= C), B.length > 0) for (var g = B.length; g > 0; g--) {
                c = B.substring(0, g).replace(/([.*+{}\[\]?])/g, "\\$1"), b = new RegExp(c);
                for (var h = f; h--; ) if (b.test(d[h])) return C = d.length - h, H = 0, p.set(d[h], !0), 
                M(), void (B.length !== g && (B = B.substring(0, g), e()));
            }
            B = "";
        }
        function h() {
            var a = p.width(), b = K.innerWidth();
            s = Math.floor(a / b);
        }
        function j(a) {
            var b = a.substring(0, s - u), c = a.substring(s - u);
            return [ b ].concat(i(c, s));
        }
        function k() {
            r.focus(), p.oneTime(1, function() {
                p.insert(r.val()), r.blur().val("");
            });
        }
        function o(a) {
            var d, h, i;
            if ("function" == typeof c.keydown && (d = c.keydown(a), d !== b)) return d;
            if (I) {
                if (38 === a.which || 80 === a.which && a.ctrlKey || (O = !0), !A || 35 !== a.which && 36 !== a.which && 37 !== a.which && 38 !== a.which && 39 !== a.which && 40 !== a.which && 13 !== a.which && 27 !== a.which) {
                    if (a.altKey) return 68 === a.which ? (p.set(E.slice(0, H) + E.slice(H).replace(/[^ ]+ |[^ ]+$/, ""), !0), 
                    !1) : !0;
                    if (13 === a.keyCode) if (a.shiftKey) p.insert("\n"); else {
                        y && E && !D && ("function" == typeof c.historyFilter && c.historyFilter(E) || !c.historyFilter) && y.append(E);
                        var j = E;
                        y.reset(), p.set(""), c.commands && c.commands(j), "function" == typeof w && N();
                    } else if (8 === a.which) A ? (B = B.slice(0, -1), e()) : "" !== E && H > 0 && (E = E.slice(0, H - 1) + E.slice(H, E.length), 
                    --H, M()); else if (67 === a.which && a.ctrlKey && a.shiftKey) F = t(); else if (86 === a.which && a.ctrlKey && a.shiftKey) "" !== F && p.insert(F); else if (9 !== a.which || a.ctrlKey || a.altKey) {
                        if (46 === a.which) return "" !== E && H < E.length && (E = E.slice(0, H) + E.slice(H + 1, E.length), 
                        M()), !0;
                        if (y && 38 === a.which || 80 === a.which && a.ctrlKey) O ? (L = E, p.set(y.current())) : p.set(y.previous()), 
                        O = !1; else if (y && 40 === a.which || 78 === a.which && a.ctrlKey) p.set(y.end() ? L : y.next()); else if (37 === a.which || 66 === a.which && a.ctrlKey) if (a.ctrlKey && 66 !== a.which) {
                            i = H - 1, h = 0, " " === E[i] && --i;
                            for (var l = i; l > 0; --l) {
                                if (" " === E[l] && " " !== E[l + 1]) {
                                    h = l + 1;
                                    break;
                                }
                                if ("\n" === E[l] && "\n" !== E[l + 1]) {
                                    h = l;
                                    break;
                                }
                            }
                            p.position(h);
                        } else H > 0 && (--H, M()); else if (82 === a.which && a.ctrlKey) A ? g(!0) : (v = w, 
                        e(), L = E, E = "", M(), A = !0); else if (71 == a.which && a.ctrlKey) A && (w = v, 
                        N(), E = L, M(), A = !1, B = ""); else if (39 === a.which || 70 === a.which && a.ctrlKey) if (a.ctrlKey && 70 !== a.which) {
                            " " === E[H] && ++H;
                            var m = /\S[\n\s]{2,}|[\n\s]+\S?/, n = E.slice(H).match(m);
                            !n || n[0].match(/^\s+$/) ? H = E.length : " " !== n[0][0] ? H += n.index + 1 : (H += n.index + n[0].length - 1, 
                            " " !== n[0][n[0].length - 1] && --H), M();
                        } else H < E.length && (++H, M()); else {
                            if (123 === a.which) return !0;
                            if (36 === a.which) p.position(0); else if (35 === a.which) p.position(E.length); else {
                                if (a.shiftKey && 45 == a.which) return k(), !0;
                                if (!a.ctrlKey && !a.metaKey) return !0;
                                if (192 === a.which) return !0;
                                if (a.metaKey) {
                                    if (82 === a.which) return !0;
                                    if (76 === a.which) return !0;
                                }
                                if (a.shiftKey) {
                                    if (84 === a.which) return !0;
                                } else {
                                    if (81 === a.which) {
                                        if ("" !== E && 0 !== H) {
                                            var q = E.slice(0, H), r = E.slice(H + 1), s = q.match(/([^ ]+ *$)/);
                                            H = q.length - s[0].length, G = q.slice(H), E = q.slice(0, H) + r, M();
                                        }
                                        return !1;
                                    }
                                    if (72 === a.which) return "" !== E && H > 0 && (E = E.slice(0, --H), H < E.length - 1 && (E += E.slice(H)), 
                                    M()), !1;
                                    if (65 === a.which) p.position(0); else if (69 === a.which) p.position(E.length); else {
                                        if (88 === a.which || 67 === a.which || 84 === a.which) return !0;
                                        if (89 === a.which) "" !== G && p.insert(G); else {
                                            if (86 === a.which) return k(), !0;
                                            if (75 === a.which) 0 === H ? (G = E, p.set("")) : H !== E.length && (G = E.slice(H), 
                                            p.set(E.slice(0, H))); else if (85 === a.which) "" !== E && 0 !== H && (G = E.slice(0, H), 
                                            p.set(E.slice(H, E.length)), p.position(0)); else if (17 === a.which) return !1;
                                        }
                                    }
                                }
                            }
                        }
                    } else p.insert("	");
                } else f(), N(), 27 === a.which && (E = ""), M(), o.call(this, a);
                return !1;
            }
        }
        var p = this, q = p.data("cmd");
        if (q) return q;
        p.addClass("cmd"), p.append('<span class="prompt"></span><span></span><span class="cursor">&nbsp;</span><span></span>');
        var r = a("<textarea/>").addClass("clipboard").appendTo(p);
        c.width && p.width(c.width);
        var s, u, v, w, x, y, z, A = !1, B = "", C = null, D = c.mask || !1, E = "", F = "", G = "", H = 0, I = c.enabled, J = c.historySize || 60, K = p.find(".cursor");
        z = n() ? function(a) {
            a ? K.addClass("blink") : K.removeClass("blink");
        } : function(a) {
            a && !I ? (K.addClass("inverted"), p.everyTime(500, "blink", d)) : I && (p.stopTime("blink", d), 
            K.removeClass("inverted"));
        };
        var L, M = function(b) {
            function c(b, c) {
                var d = b.length;
                if (c === d) g.html(a.terminal.encode(b, !0)), K.html("&nbsp;"), h.html(""); else if (0 === c) g.html(""), 
                K.html(a.terminal.encode(b.slice(0, 1), !0)), h.html(a.terminal.encode(b.slice(1), !0)); else {
                    var e = a.terminal.encode(b.slice(0, c), !0);
                    g.html(e);
                    var f = b.slice(c, c + 1);
                    K.html(" " === f ? "&nbsp;" : a.terminal.encode(f, !0)), c === b.length - 1 ? h.html("") : h.html(a.terminal.encode(b.slice(c + 1), !0));
                }
            }
            function d(b) {
                return "<div>" + a.terminal.encode(b, !0) + "</div>";
            }
            function e(b) {
                var c = h;
                a.each(b, function(b, e) {
                    c = a(d(e)).insertAfter(c).addClass("clear");
                });
            }
            function f(b) {
                a.each(b, function(a, b) {
                    g.before(d(b));
                });
            }
            var g = K.prev(), h = K.next();
            return function() {
                var k, l, m = D ? E.replace(/./g, "*") : E;
                if (b.find("div").remove(), g.html(""), m.length > s - u - 1 || m.match(/\n/)) {
                    var n, o = m.match(/\t/g), p = o ? 3 * o.length : 0;
                    if (o && (m = m.replace(/\t/g, "\x00\x00\x00\x00")), m.match(/\n/)) {
                        var q = m.split("\n");
                        for (l = s - u - 1, k = 0; k < q.length - 1; ++k) q[k] += " ";
                        for (q[0].length > l ? (n = [ q[0].substring(0, l) ], n = n.concat(i(q[0].substring(l), s))) : n = [ q[0] ], 
                        k = 1; k < q.length; ++k) q[k].length > s ? n = n.concat(i(q[k], s)) : n.push(q[k]);
                    } else n = j(m);
                    if (o && (n = a.map(n, function(a) {
                        return a.replace(/\x00\x00\x00\x00/g, "	");
                    })), l = n[0].length, 0 === l && 1 === n.length) ; else if (l > H) c(n[0], H), e(n.slice(1)); else if (H === l) g.before(d(n[0])), 
                    c(n[1], 0), e(n.slice(2)); else {
                        var r = n.length;
                        if (l > H) c(n[0], H), e(n.slice(1)); else if (H === l) g.before(d(n[0])), c(n[1], 0), 
                        e(n.slice(2)); else {
                            var t = n.slice(-1)[0], v = m.length - H, w = t.length, x = 0;
                            if (w >= v) f(n.slice(0, -1)), x = w === v ? 0 : w - v, c(t, x + p); else if (3 === r) g.before("<div>" + a.terminal.encode(n[0], !0) + "</div>"), 
                            c(n[1], H - l - 1), h.after('<div class="clear">' + a.terminal.encode(n[2], !0) + "</div>"); else {
                                var y, z;
                                for (x = H, k = 0; k < n.length; ++k) {
                                    var A = n[k].length;
                                    if (!(x > A)) break;
                                    x -= A;
                                }
                                z = n[k], y = k, x === z.length && (x = 0, z = n[++y]), c(z, x), f(n.slice(0, y)), 
                                e(n.slice(y + 1));
                            }
                        }
                    }
                } else "" === m ? (g.html(""), K.html("&nbsp;"), h.html("")) : c(m, H);
            };
        }(p), N = function() {
            function b(b) {
                u = m(b), c.html(a.terminal.format(a.terminal.encode(b)));
            }
            var c = p.find(".prompt");
            return function() {
                switch (typeof w) {
                  case "string":
                    b(w);
                    break;

                  case "function":
                    w(b);
                }
            };
        }(), O = !0;
        a.extend(p, {
            name: function(a) {
                if (a !== b) {
                    x = a;
                    var c = y && y.enabled() || !y;
                    return y = new l(a, J), c || y.disable(), p;
                }
                return x;
            },
            purge: function() {
                return y.clear(), p;
            },
            history: function() {
                return y;
            },
            set: function(a, d) {
                return a !== b && (E = a, d || (H = E.length), M(), "function" == typeof c.onCommandChange && c.onCommandChange(E)), 
                p;
            },
            insert: function(a, b) {
                return H === E.length ? E += a : E = 0 === H ? a + E : E.slice(0, H) + a + E.slice(H), 
                b || (H += a.length), M(), "function" == typeof c.onCommandChange && c.onCommandChange(E), 
                p;
            },
            get: function() {
                return E;
            },
            commands: function(a) {
                return a ? (c.commands = a, p) : a;
            },
            destroy: function() {
                return a(document.documentElement || window).unbind(".cmd"), p.stopTime("blink", d), 
                p.find(".cursor").next().remove().end().prev().remove().end().remove(), p.find(".prompt, .clipboard").remove(), 
                p.removeClass("cmd").removeData("cmd"), p;
            },
            prompt: function(a) {
                if (a === b) return w;
                if ("string" != typeof a && "function" != typeof a) throw "prompt must be a function or string";
                return w = a, N(), M(), p;
            },
            kill_text: function() {
                return G;
            },
            position: function(a) {
                return "number" == typeof a ? (H = 0 > a ? 0 : a > E.length ? E.length : a, M(), 
                p) : H;
            },
            visible: function() {
                var a = p.visible;
                return function() {
                    a.apply(p, []), M(), N();
                };
            }(),
            show: function() {
                var a = p.show;
                return function() {
                    a.apply(p, []), M(), N();
                };
            }(),
            resize: function(a) {
                return a ? s = a : h(), M(), p;
            },
            enable: function() {
                return I = !0, z(!0), p;
            },
            isenabled: function() {
                return I;
            },
            disable: function() {
                return I = !1, z(!1), p;
            },
            mask: function(a) {
                return "boolean" == typeof a ? (D = a, M(), p) : D;
            }
        }), p.name(c.name || c.prompt || ""), w = c.prompt || "> ", N(), (c.enabled === b || c.enabled === !0) && p.enable();
        return a(document.documentElement || window).bind("keypress.cmd", function(d) {
            var f;
            if (d.ctrlKey && 99 === d.which) return !0;
            if (A || "function" != typeof c.keypress || (f = c.keypress(d)), f !== b && !f) return f;
            if (I) {
                if (a.inArray(d.which, [ 38, 13, 0, 8 ]) > -1 && 123 !== d.keyCode && (38 !== d.which || !d.shiftKey)) return !1;
                if (!d.ctrlKey && (!d.altKey || 100 !== d.which) || d.altKey) return A ? (B += String.fromCharCode(d.which), 
                g(), e()) : p.insert(String.fromCharCode(d.which)), !1;
            }
        }).bind("keydown.cmd", o), p.data("cmd", p), p;
    };
    var w = [ "black", "silver", "gray", "white", "maroon", "red", "purple", "fuchsia", "green", "lime", "olive", "yellow", "navy", "blue", "teal", "aqua", "aliceblue", "antiquewhite", "aqua", "aquamarine", "azure", "beige", "bisque", "black", "blanchedalmond", "blue", "blueviolet", "brown", "burlywood", "cadetblue", "chartreuse", "chocolate", "coral", "cornflowerblue", "cornsilk", "crimson", "cyan", "darkblue", "darkcyan", "darkgoldenrod", "darkgray", "darkgreen", "darkgrey", "darkkhaki", "darkmagenta", "darkolivegreen", "darkorange", "darkorchid", "darkred", "darksalmon", "darkseagreen", "darkslateblue", "darkslategray", "darkslategrey", "darkturquoise", "darkviolet", "deeppink", "deepskyblue", "dimgray", "dimgrey", "dodgerblue", "firebrick", "floralwhite", "forestgreen", "fuchsia", "gainsboro", "ghostwhite", "gold", "goldenrod", "gray", "green", "greenyellow", "grey", "honeydew", "hotpink", "indianred", "indigo", "ivory", "khaki", "lavender", "lavenderblush", "lawngreen", "lemonchiffon", "lightblue", "lightcoral", "lightcyan", "lightgoldenrodyellow", "lightgray", "lightgreen", "lightgrey", "lightpink", "lightsalmon", "lightseagreen", "lightskyblue", "lightslategray", "lightslategrey", "lightsteelblue", "lightyellow", "lime", "limegreen", "linen", "magenta", "maroon", "mediumaquamarine", "mediumblue", "mediumorchid", "mediumpurple", "mediumseagreen", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "mintcream", "mistyrose", "moccasin", "navajowhite", "navy", "oldlace", "olive", "olivedrab", "orange", "orangered", "orchid", "palegoldenrod", "palegreen", "paleturquoise", "palevioletred", "papayawhip", "peachpuff", "peru", "pink", "plum", "powderblue", "purple", "red", "rosybrown", "royalblue", "saddlebrown", "salmon", "sandybrown", "seagreen", "seashell", "sienna", "silver", "skyblue", "slateblue", "slategray", "slategrey", "snow", "springgreen", "steelblue", "tan", "teal", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "whitesmoke", "yellow", "yellowgreen" ], x = /(\[\[[gbiuso]*;[^;]*;[^\]]*\](?:[^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?)/i, y = /\[\[([gbiuso]*);([^;]*);([^;\]]*);?([^;\]]*);?([^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/gi, z = /\[\[([gbiuso]*;[^;\]]*;[^;\]]*(?:;|[^\]()]*);?[^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/gi, A = /^\[\[([gbiuso]*;[^;\]]*;[^;\]]*(?:;|[^\]()]*);?[^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]$/gi, B = /^#([0-9a-f]{3}|[0-9a-f]{6})$/i, C = /\bhttps?:\/\/(?:(?!&[^;]+;)[^\s"'<>)])+\b/g, D = /((([^<>('")[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,})))/g, E = /('[^']*'|"(\\"|[^"])*"|\/(\\\/|[^\/])+\/[gimy]*|(\\ |[^ ])+|[\w-]+)/g, F = /(\[\[[gbiuso]*;[^;]*;[^\]]*\])/i, G = /\[\[[gbiuso]*;[^;]*;[^\]]*\]?$/i;
    a.terminal = {
        valid_color: function(b) {
            return b.match(B) || -1 !== a.inArray(b.toLowerCase(), w);
        },
        escape_regex: function(a) {
            var b = /([\^\$\[\]\(\)\+\*\.\|])/g;
            return a.replace(b, "\\$1");
        },
        have_formatting: function(a) {
            return a.match(z);
        },
        is_formatting: function(a) {
            return a.match(A);
        },
        format_split: function(a) {
            return a.split(x);
        },
        split_equal: function(a, b) {
            for (var c = !1, d = !1, e = "", f = [], g = a.replace(z, function(a, b, c) {
                var d = b.match(/;/g).length;
                return d = 2 == d ? ";;" : 3 == d ? ";" : "", "[[" + b + d + c.replace(/\\\]/g, "&#93;").replace(/\n/g, "\\n") + "]" + c + "]";
            }).split(/\n/g), h = 0, i = g.length; i > h; ++h) if ("" !== g[h]) for (var j = g[h], k = 0, l = 0, m = 0, n = j.length; n > m; ++m) {
                if ("[" === j[m] && "[" === j[m + 1]) c = !0; else if (c && "]" === j[m]) d ? (c = !1, 
                d = !1) : d = !0; else if (c && d || !c) {
                    if ("&" === j[m]) {
                        var o = j.substring(m).match(/^(&[^;]+;)/);
                        if (!o) throw "Unclosed html entity in line " + (h + 1) + " at char " + (m + 1);
                        m += o[1].length - 2, m === n - 1 && f.push(p + o[1]);
                        continue;
                    }
                    "]" === j[m] && "\\" === j[m - 1] ? --l : ++l;
                }
                if (l === b || m === n - 1) {
                    var p = j.substring(k, m + 1);
                    e && (p = e + p, p.match("]") && (e = "")), k = m + 1, l = 0;
                    var q = p.match(z);
                    if (q) {
                        var r = q[q.length - 1];
                        if ("]" !== r[r.length - 1]) e = r.match(F)[1], p += "]"; else if (p.match(G)) {
                            var s = p.length;
                            s - r[r.length - 1].length;
                            p = p.replace(G, ""), e = r.match(F)[1];
                        }
                    }
                    f.push(p);
                }
            } else f.push("");
            return f;
        },
        encode: function(a, b) {
            return a = b ? a.replace(/&(?![^=]+=)/g, "&amp;") : a.replace(/&(?!#[0-9]+;|[a-zA-Z]+;|[^= "]+=[^=])/g, "&amp;"), 
            a.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/ /g, "&nbsp;").replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;");
        },
        format: function(b, c) {
            var d = a.extend({}, {
                linksNoReferrer: !1
            }, c || {});
            if ("string" == typeof b) {
                var e = a.terminal.format_split(b);
                return e && e.length > 1 && (b = a.map(e, function(b) {
                    return "" === b ? b : "[" === b.substring(0, 1) ? b.replace(y, function(b, c, d, e, f, g, h) {
                        if ("" === h) return "";
                        h = h.replace(/\\]/g, "]");
                        var i = "";
                        -1 !== c.indexOf("b") && (i += "font-weight:bold;");
                        var j = [];
                        -1 !== c.indexOf("u") && j.push("underline"), -1 !== c.indexOf("s") && j.push("line-through"), 
                        -1 !== c.indexOf("o") && j.push("overline"), j.length && (i += "text-decoration:" + j.join(" ") + ";"), 
                        -1 !== c.indexOf("i") && (i += "font-style:italic;"), a.terminal.valid_color(d) && (i += "color:" + d + ";", 
                        -1 !== c.indexOf("g") && (i += "text-shadow:0 0 5px " + d + ";")), a.terminal.valid_color(e) && (i += "background-color:" + e);
                        var k;
                        k = "" === g ? h : g.replace(/&#93;/g, "]");
                        var l = '<span style="' + i + '"' + ("" !== f ? ' class="' + f + '"' : "") + ' data-text="' + k.replace('"', "&quote;") + '">' + h + "</span>";
                        return l;
                    }) : "<span>" + b + "</span>";
                }).join("")), a.map(b.split(/(<\/?span[^>]*>)/g), function(a) {
                    return a.match(/span/) ? a : a.replace(C, function(a) {
                        var b = a.match(/\.$/);
                        return a = a.replace(/\.$/, ""), '<a target="_blank" ' + (d.linksNoReferer ? ' rel="noreferrer" ' : "") + 'href="' + a + '">' + a + "</a>" + (b ? "." : "");
                    }).replace(D, '<a href="mailto:$1">$1</a>');
                }).join("").replace(/<span><br\/?><\/span>/g, "<br/>");
            }
            return "";
        },
        escape_brackets: function(a) {
            return a.replace(/\[/g, "&#91;").replace(/\]/g, "&#93;");
        },
        strip: function(a) {
            return a.replace(y, "$6");
        },
        active: function() {
            return P.front();
        },
        overtyping: function(a) {
            return a.replace(/((?:_\x08.|.\x08_)+)/g, function(a, b) {
                return "[[u;;]" + a.replace(/_x08|\x08_|_\u0008|\u0008_/g, "") + "]";
            }).replace(/((?:.\x08.)+)/g, function(a, b) {
                return "[[b;#fff;]" + a.replace(/(.)(?:\x08|\u0008)(.)/g, function(a, b, c) {
                    return c;
                }) + "]";
            });
        },
        ansi_colors: {
            normal: {
                black: "#000",
                red: "#A00",
                green: "#008400",
                yellow: "#A50",
                blue: "#00A",
                magenta: "#A0A",
                cyan: "#0AA",
                white: "#AAA"
            },
            faited: {
                black: "#000",
                red: "#640000",
                green: "#006100",
                yellow: "#737300",
                blue: "#000087",
                magenta: "#650065",
                cyan: "#008787",
                white: "#818181"
            },
            bold: {
                black: "#000",
                red: "#F55",
                green: "#44D544",
                yellow: "#FF5",
                blue: "#55F",
                magenta: "#F5F",
                cyan: "#5FF",
                white: "#FFF"
            },
            palette: [ "#000000", "#AA0000", "#00AA00", "#AA5500", "#0000AA", "#AA00AA", "#00AAAA", "#AAAAAA", "#555555", "#FF5555", "#55FF55", "#FFFF55", "#5555FF", "#FF55FF", "#55FFFF", "#FFFFFF", "#000000", "#00005F", "#000087", "#0000AF", "#0000D7", "#0000FF", "#005F00", "#005F5F", "#005F87", "#005FAF", "#005FD7", "#005FFF", "#008700", "#00875F", "#008787", "#0087AF", "#0087D7", "#00AF00", "#00AF5F", "#00AF87", "#00AFAF", "#00AFD7", "#00AFFF", "#00D700", "#00D75F", "#00D787", "#00D7AF", "#00D7D7", "#00D7FF", "#00FF00", "#00FF5F", "#00FF87", "#00FFAF", "#00FFD7", "#00FFFF", "#5F0000", "#5F005F", "#5F0087", "#5F00AF", "#5F00D7", "#5F00FF", "#5F5F00", "#5F5F5F", "#5F5F87", "#5F5FAF", "#5F5FD7", "#5F5FFF", "#5F8700", "#5F875F", "#5F8787", "#5F87AF", "#5F87D7", "#5F87FF", "#5FAF00", "#5FAF5F", "#5FAF87", "#5FAFAF", "#5FAFD7", "#5FAFFF", "#5FD700", "#5FD75F", "#5FD787", "#5FD7AF", "#5FD7D7", "#5FD7FF", "#5FFF00", "#5FFF5F", "#5FFF87", "#5FFFAF", "#5FFFD7", "#5FFFFF", "#870000", "#87005F", "#870087", "#8700AF", "#8700D7", "#8700FF", "#875F00", "#875F5F", "#875F87", "#875FAF", "#875FD7", "#875FFF", "#878700", "#87875F", "#878787", "#8787AF", "#8787D7", "#8787FF", "#87AF00", "#87AF5F", "#87AF87", "#87AFAF", "#87AFD7", "#87AFFF", "#87D700", "#87D75F", "#87D787", "#87D7AF", "#87D7D7", "#87D7FF", "#87FF00", "#87FF5F", "#87FF87", "#87FFAF", "#87FFD7", "#87FFFF", "#AF0000", "#AF005F", "#AF0087", "#AF00AF", "#AF00D7", "#AF00FF", "#AF5F00", "#AF5F5F", "#AF5F87", "#AF5FAF", "#AF5FD7", "#AF5FFF", "#AF8700", "#AF875F", "#AF8787", "#AF87AF", "#AF87D7", "#AF87FF", "#AFAF00", "#AFAF5F", "#AFAF87", "#AFAFAF", "#AFAFD7", "#AFAFFF", "#AFD700", "#AFD75F", "#AFD787", "#AFD7AF", "#AFD7D7", "#AFD7FF", "#AFFF00", "#AFFF5F", "#AFFF87", "#AFFFAF", "#AFFFD7", "#AFFFFF", "#D70000", "#D7005F", "#D70087", "#D700AF", "#D700D7", "#D700FF", "#D75F00", "#D75F5F", "#D75F87", "#D75FAF", "#D75FD7", "#D75FFF", "#D78700", "#D7875F", "#D78787", "#D787AF", "#D787D7", "#D787FF", "#D7AF00", "#D7AF5F", "#D7AF87", "#D7AFAF", "#D7AFD7", "#D7AFFF", "#D7D700", "#D7D75F", "#D7D787", "#D7D7AF", "#D7D7D7", "#D7D7FF", "#D7FF00", "#D7FF5F", "#D7FF87", "#D7FFAF", "#D7FFD7", "#D7FFFF", "#FF0000", "#FF005F", "#FF0087", "#FF00AF", "#FF00D7", "#FF00FF", "#FF5F00", "#FF5F5F", "#FF5F87", "#FF5FAF", "#FF5FD7", "#FF5FFF", "#FF8700", "#FF875F", "#FF8787", "#FF87AF", "#FF87D7", "#FF87FF", "#FFAF00", "#FFAF5F", "#FFAF87", "#FFAFAF", "#FFAFD7", "#FFAFFF", "#FFD700", "#FFD75F", "#FFD787", "#FFD7AF", "#FFD7D7", "#FFD7FF", "#FFFF00", "#FFFF5F", "#FFFF87", "#FFFFAF", "#FFFFD7", "#FFFFFF", "#080808", "#121212", "#1C1C1C", "#262626", "#303030", "#3A3A3A", "#444444", "#4E4E4E", "#585858", "#626262", "#6C6C6C", "#767676", "#808080", "#8A8A8A", "#949494", "#9E9E9E", "#A8A8A8", "#B2B2B2", "#BCBCBC", "#C6C6C6", "#D0D0D0", "#DADADA", "#E4E4E4", "#EEEEEE" ]
        },
        from_ansi: function() {
            function b(b) {
                var e, f = b.split(";"), g = !1, h = !1, i = !1, j = [], k = "", l = "", m = !1, n = !1, o = !1, p = a.terminal.ansi_colors.palette;
                for (var q in f) {
                    switch (e = parseInt(f[q], 10)) {
                      case 1:
                        j.push("b"), i = !0, g = !1;
                        break;

                      case 4:
                        j.push("u");
                        break;

                      case 3:
                        j.push("i");
                        break;

                      case 5:
                        o = !0;
                        break;

                      case 38:
                        m = !0;
                        break;

                      case 48:
                        n = !0;
                        break;

                      case 2:
                        g = !0, i = !1;
                        break;

                      case 7:
                        h = !0;
                        break;

                      default:
                        m && o && p[e - 1] ? k = p[e - 1] : c[e] && (k = c[e]), n && o && p[e - 1] ? l = p[e - 1] : d[e] && (l = d[e]);
                    }
                    5 !== e && (o = !1);
                }
                if (h) if (k && l) {
                    var r = l;
                    l = k, k = r;
                } else k = "black", l = "white";
                var s, t;
                return s = t = i ? a.terminal.ansi_colors.bold : g ? a.terminal.ansi_colors.faited : a.terminal.ansi_colors.normal, 
                [ j.join(""), m ? k : s[k], n ? l : t[l] ];
            }
            var c = {
                30: "black",
                31: "red",
                32: "green",
                33: "yellow",
                34: "blue",
                35: "magenta",
                36: "cyan",
                37: "white",
                39: "white"
            }, d = {
                40: "black",
                41: "red",
                42: "green",
                43: "yellow",
                44: "blue",
                45: "magenta",
                46: "cyan",
                47: "white",
                49: "black"
            };
            return function(a) {
                var c = a.split(/(\x1B\[[0-9;]*[A-Za-z])/g);
                if (1 == c.length) return a;
                var d = [];
                c.length > 3 && "[0m" == c.slice(0, 3).join("") && (c = c.slice(3));
                for (var e, f, g, h, i = !1, j = 0; j < c.length; ++j) if (h = c[j].match(/^\x1B\[([0-9;]*)([A-Za-z])$/)) switch (h[2]) {
                  case "m":
                    if ("" === h[1]) continue;
                    "0" !== h[1] && (g = b(h[1])), i ? (d.push("]"), "0" == h[1] ? (i = !1, e = f = "") : (g[1] = g[1] || e, 
                    g[2] = g[2] || f, d.push("[[" + g.join(";") + "]"), g[1] && (e = g[1]), g[2] && (f = g[2]))) : "0" != h[1] && (i = !0, 
                    d.push("[[" + g.join(";") + "]"), g[1] && (e = g[1]), g[2] && (f = g[2]));
                } else d.push(c[j]);
                return i && d.push("]"), d.join("");
            };
        }(),
        parseArguments: function(b) {
            return a.map(b.match(E) || [], function(a) {
                if ("'" === a[0] && "'" === a[a.length - 1]) return a.replace(/^'|'$/g, "");
                if ('"' === a[0] && '"' === a[a.length - 1]) return a = a.replace(/^"|"$/g, "").replace(/\\([" ])/g, "$1"), 
                a.replace(/\\\\|\\t|\\n/g, function(a) {
                    return "t" === a[1] ? "	" : "n" === a[1] ? "\n" : "\\";
                }).replace(/\\x([0-9a-f]+)/gi, function(a, b) {
                    return String.fromCharCode(parseInt(b, 16));
                }).replace(/\\0([0-7]+)/g, function(a, b) {
                    return String.fromCharCode(parseInt(b, 8));
                });
                if (a.match(/^\/(\\\/|[^\/])+\/[gimy]*$/)) {
                    var b = a.match(/^\/([^\/]+)\/([^\/]*)$/);
                    return new RegExp(b[1], b[2]);
                }
                return a.match(/^-?[0-9]+$/) ? parseInt(a, 10) : a.match(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/) ? parseFloat(a) : a.replace(/\\ /g, " ");
            });
        },
        splitArguments: function(b) {
            return a.map(b.match(E) || [], function(a) {
                return "'" === a[0] && "'" === a[a.length - 1] ? a.replace(/^'|'$/g, "") : '"' === a[0] && '"' === a[a.length - 1] ? a.replace(/^"|"$/g, "").replace(/\\([" ])/g, "$1") : "/" === a[0] && "/" == a[a.length - 1] ? a : a.replace(/\\ /g, " ");
            });
        },
        parseCommand: function(b) {
            return o(b, a.terminal.parseArguments);
        },
        splitCommand: function(b) {
            return o(b, a.terminal.splitArguments);
        },
        test: function() {
            function b(a, b) {
                c.echo(b + " &#91;" + (a ? "[[b;#44D544;]PASS]" : "[[b;#FF5555;]FAIL]") + "&#93;");
            }
            var c = a.terminal.active();
            if (!c) {
                c = a("body").terminal(a.noop).css("margin", 0);
                var d = (c.outerHeight() - c.height(), a(window));
                d.resize(function() {
                    c.css("height", a(window).height() - 20);
                }).resize();
            }
            c.echo("Testing...");
            var e = 'name "foo bar" baz /^asd [x]/ str\\ str 10 1e10', f = a.terminal.splitCommand(e);
            b("name" === f.name && "foo bar" === f.args[0] && "baz" === f.args[1] && "/^asd [x]/" === f.args[2] && "str str" === f.args[3] && "10" === f.args[4] && "1e10" === f.args[5], "$.terminal.splitCommand"), 
            f = a.terminal.parseCommand(e), b("name" === f.name && "foo bar" === f.args[0] && "baz" === f.args[1] && "regexp" === a.type(f.args[2]) && "^asd [x]" === f.args[2].source && "str str" === f.args[3] && 10 === f.args[4] && 1e10 === f.args[5], "$.terminal.parseCommand"), 
            e = "[2;31;46mFoo[1;3;4;32;45mBar[0m[7mBaz", b("[[;#640000;#008787]Foo][[biu;#44D544;#F5F]Bar][[;#000;#AAA]Baz]" === a.terminal.from_ansi(e), "$.terminal.from_ansi"), 
            e = "[[biugs;#fff;#000]Foo][[i;;;foo]Bar][[ous;;]Baz]", c.echo("$.terminal.format"), 
            b('<span style="font-weight:bold;text-decoration:underline line-through;font-style:italic;color:#fff;text-shadow:0 0 5px #fff;background-color:#000" data-text="Foo">Foo</span><span style="font-style:italic;" class="foo" data-text="Bar">Bar</span><span style="text-decoration:underline line-through overline;" data-text="Baz">Baz</span>' === a.terminal.format(e), "	formatting"), 
            e = "http://terminal.jcubic.pl/examples.php https://www.google.com/?q=jquery%20terminal", 
            b('<a target="_blank" href="http://terminal.jcubic.pl/examples.php">http://terminal.jcubic.pl/examples.php</a> <a target="_blank" href="https://www.google.com/?q=jquery%20terminal">https://www.google.com/?q=jquery%20terminal</a>' === a.terminal.format(e), "	urls"), 
            e = "foo@bar.com baz.quux@example.com", b('<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:baz.quux@example.com">baz.quux@example.com</a>' === a.terminal.format(e), "	emails"), 
            e = "-_-[[biugs;#fff;#000]Foo]-_-[[i;;;foo]Bar]-_-[[ous;;]Baz]-_-", b("-_-Foo-_-Bar-_-Baz-_-" === a.terminal.strip(e), "$.terminal.strip"), 
            e = "[[bui;#fff;]Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus] est [[b;;#f00]consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam] non magna quis [[i;;]tortor malesuada aliquam] eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus [[ub;#fff;]felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat], ac mattis enim.", 
            c.echo("$.terminal.split_equal");
            for (var g = [ 10, 40, 60, 400 ], h = g.length; h--; ) {
                for (var i = a.terminal.split_equal(e, g[h]), j = !0, k = 0; k < i.length; ++k) if (a.terminal.strip(i[k]).length > g[h]) {
                    j = !1;
                    break;
                }
                b(j, "	split " + g[h]);
            }
        }
    }, a.fn.visible = function() {
        return this.css("visibility", "visible");
    }, a.fn.hidden = function() {
        return this.css("visibility", "hidden");
    };
    var H = {};
    a.jrpc = function(b, c, d, e, f) {
        H[b] = H[b] || 0;
        var g = a.json_stringify({
            jsonrpc: "2.0",
            method: c,
            params: d,
            id: ++H[b]
        });
        return a.ajax({
            url: b,
            data: g,
            success: function(b, c, d) {
                var g = d.getResponseHeader("Content-Type");
                if (!g.match(/application\/json/)) {
                    if (!console || !console.warn) throw new Error("WARN: Response Content-Type is not application/json");
                    console.warn("Response Content-Type is not application/json");
                }
                var h;
                try {
                    h = a.parseJSON(b);
                } catch (i) {
                    if (!f) throw new Error("Invalid JSON");
                    return void f(d, "Invalid JSON", i);
                }
                e(h, c, d);
            },
            error: f,
            contentType: "application/json",
            dataType: "text",
            async: !0,
            cache: !1,
            type: "POST"
        });
    };
    var I = "0.8.8", J = !I.match(/^\{\{/), K = "Copyright (c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>", L = J ? " version " + I : " ", M = new RegExp(" {" + L.length + "}$"), N = [ [ "jQuery Terminal", "(c) 2011-2013 jcubic" ], [ "jQuery Terminal Emulator" + (J ? " v. " + I : ""), K.replace(/ *<.*>/, "") ], [ "jQuery Terminal Emulator" + (J ? L : ""), K.replace(/^Copyright /, "") ], [ "      _______                 ________                        __", "     / / _  /_ ____________ _/__  ___/______________  _____  / /", " __ / / // / // / _  / _/ // / / / _  / _/     / /  \\/ / _ \\/ /", "/  / / // / // / ___/ // // / / / ___/ // / / / / /\\  / // / /__", "\\___/____ \\\\__/____/_/ \\__ / /_/____/_//_/ /_/ /_/  \\/\\__\\_\\___/", "         \\/          /____/                                   ".replace(M, " ") + L, K ], [ "      __ _____                     ________                              __", "     / // _  /__ __ _____ ___ __ _/__  ___/__ ___ ______ __ __  __ ___  / /", " __ / // // // // // _  // _// // / / // _  // _//     // //  \\/ // _ \\/ /", "/  / // // // // // ___// / / // / / // ___// / / / / // // /\\  // // / /__", "\\___//____ \\\\___//____//_/ _\\_  / /_//____//_/ /_/ /_//_//_/ /_/ \\__\\_\\___/", "          \\/              /____/                                          ".replace(M, "") + L, K ] ];
    a.terminal.defaults = {
        prompt: "> ",
        history: !0,
        exit: !0,
        clear: !0,
        enabled: !0,
        historySize: 60,
        checkArity: !0,
        exceptionHandler: null,
        cancelableAjax: !0,
        processArguments: !0,
        linksNoReferrer: !1,
        login: null,
        outputLimit: -1,
        onAjaxError: null,
        onRPCError: null,
        completion: !1,
        historyFilter: null,
        onInit: a.noop,
        onClear: a.noop,
        onBlur: a.noop,
        onFocus: a.noop,
        onTerminalChange: a.noop,
        onExit: a.noop,
        keypress: a.noop,
        keydown: a.noop,
        strings: {
            wrongPasswordTryAgain: "Wrong password try again!",
            wrongPassword: "Wrong password!",
            ajaxAbortError: "Error while aborting ajax call!",
            wrongArity: "Wrong number of arguments. Function '%s' expect %s got %s!",
            commandNotFound: "Command '%s' Not Found!",
            oneRPCWithIgnore: "You can use only one rpc with ignoreSystemDescribe",
            oneInterpreterFunction: "You can't use more then one function (rpc with ignoreSystemDescribe is count as one)",
            loginFunctionMissing: "You don't have login function",
            noTokenError: "Access denied (no token)",
            serverResponse: "Server reponse is",
            wrongGreetings: "Wrong value of greetings parameter",
            notWhileLogin: "You can't call that function while in login",
            loginIsNotAFunction: "Authenticate must be a function",
            canExitError: "You can't exit from main interpeter",
            invalidCompletion: "Invalid completion",
            login: "login",
            password: "password"
        }
    };
    var O = [], P = new j();
    a.fn.terminal = function(c, d) {
        function e(b) {
            return "function" == typeof da.processArguments ? o(b, da.processArguments) : da.processArguments ? a.terminal.parseCommand(b) : a.terminal.splitCommand(b);
        }
        function f(b) {
            "string" == typeof b ? R.echo(b) : b instanceof Array ? R.echo(a.map(b, function(b) {
                return a.json_stringify(b);
            }).join(" ")) : "object" == typeof b ? R.echo(a.json_stringify(b)) : R.echo(b);
        }
        function g(a) {
            "function" == typeof da.onRPCError ? da.onRPCError.call(R, a) : R.error("&#91;RPC&#93; " + a.message);
        }
        function h(b) {
            var c = function(c, d) {
                R.pause(), a.jrpc(b, c, d, function(a) {
                    a.error ? g(a.error) : "function" == typeof da.processRPCResponse ? da.processRPCResponse.call(R, a.result) : f(a.result), 
                    R.resume();
                }, j);
            };
            return function(a, b) {
                if ("" !== a) if (a = e(a), da.login && "help" !== a.name) {
                    var d = b.token();
                    d ? c(a.name, [ d ].concat(a.args)) : b.error("&#91;AUTH&#93; " + ea.noTokenError);
                } else c(a.name, a.args);
            };
        }
        function i(c, d, f) {
            return function(g, h) {
                if ("" !== g) {
                    var j = e(g), k = c[j.name], l = a.type(k);
                    if ("function" === l) {
                        if (!d || k.length === j.args.length) return k.apply(R, j.args);
                        R.error("&#91;Arity&#93; " + sprintf(ea.wrongArity, j.name, k.length, j.args.length));
                    } else if ("object" === l || "string" === l) {
                        var m = [];
                        "object" === l && (m = Object.keys(k), k = i(k, d)), h.push(k, {
                            prompt: j.name + "> ",
                            name: j.name,
                            completion: "object" === l ? function(a, b, c) {
                                c(m);
                            } : b
                        });
                    } else "function" === a.type(f) ? f(g, R) : "function" === a.type(da.onCommandNotFound) ? da.onCommandNotFound(g, R) : h.error(sprintf(ea.commandNotFound, j.name));
                }
            };
        }
        function j(a, b, c) {
            R.resume(), "function" == typeof da.onAjaxError ? da.onAjaxError.call(R, a, b, c) : "abort" !== b && R.error("&#91;AJAX&#93; " + b + " - " + ea.serverResponse + ": \n" + a.responseText);
        }
        function l(b, c, d) {
            a.jrpc(b, "system.describe", [], function(e) {
                if (e.procs) {
                    var h = {};
                    a.each(e.procs, function(d, e) {
                        h[e.name] = function() {
                            var d = c && "help" != e.name, h = Array.prototype.slice.call(arguments), i = h.length + (d ? 1 : 0);
                            da.checkArity && e.params && e.params.length !== i ? R.error("&#91;Arity&#93; " + sprintf(ea.wrongArity, e.name, e.params.length, i)) : (R.pause(), 
                            d && (h = [ R.token(!0) ].concat(h)), a.jrpc(b, e.name, h, function(a) {
                                a.error ? g(a.error) : f(a.result), R.resume();
                            }, j));
                        };
                    }), d(h);
                } else d(null);
            }, function() {
                d(null);
            });
        }
        function m(b, c, d) {
            d = d || a.noop;
            var e, f, g = a.type(b), j = {}, k = 0;
            if ("array" === g) {
                var m = {};
                !function n(b, d) {
                    if (b.length) {
                        var e = b[0], g = b.slice(1), i = a.type(e);
                        "string" === i ? (k++, R.pause(), da.ignoreSystemDescribe ? (1 === k ? f = h(e) : R.error(ea.oneRPCWithIgnore), 
                        n(g, d)) : l(e, c, function(b) {
                            b && a.extend(m, b), R.resume(), n(g, d);
                        })) : "function" === i ? f ? R.error(ea.oneInterpreterFunction) : f = e : "object" === i && (a.extend(m, e), 
                        n(g, d));
                    } else d();
                }(b, function() {
                    e = Object.keys(m), j.interpreter = i(m, !1, f), j.completion = function(a, b, c) {
                        c(e);
                    }, d(j);
                });
            } else if ("string" === g) da.ignoreSystemDescribe ? d({
                interpreter: h(b),
                completion: da.completion
            }) : (R.pause(), l(b, c, function(a) {
                if (a) {
                    var c = Object.keys(a);
                    j.interpreter = i(a, !1), j.completion = function(a, b, d) {
                        d(c);
                    };
                } else j.interpreter = h(b), j.completion = da.completion;
                R.resume(), d(j);
            })); else if ("object" === g) e = Object.keys(b), j.interpreter = i(b, da.checkArity), 
            j.completion = function(a, b, c) {
                c(e);
            }, d(j); else {
                if ("undefined" === g) b = a.noop; else if ("function" !== g) throw g + " is invalid interpreter value";
                d({
                    interpreter: b,
                    completion: da.completion
                });
            }
        }
        function n(b, c) {
            var d = "boolean" === a.type(c) ? "login" : c;
            return function(c, e, f, g) {
                R.pause(), a.jrpc(b, d, [ c, e ], function(a) {
                    R.resume(), f(!a.error && a.result ? a.result : null);
                }, j);
            };
        }
        function q(a) {
            return "string" == typeof a ? a : "string" == typeof a.fileName ? a.fileName + ": " + a.message : a.message;
        }
        function v(a, b) {
            "function" == typeof da.exceptionHandler ? da.exceptionHandler.call(R, a) : R.exception(a, b);
        }
        function w() {
            var a = S.prop ? S.prop("scrollHeight") : S.attr("scrollHeight");
            S.scrollTop(a);
        }
        function x(a, b) {
            try {
                if ("function" == typeof b) b(function() {}); else if ("string" != typeof b) {
                    var c = a + " must be string or function";
                    throw c;
                }
            } catch (d) {
                return v(d, a.toUpperCase()), !1;
            }
            return !0;
        }
        function y(b, c) {
            try {
                var d = a.extend({
                    raw: !1,
                    finalize: a.noop
                }, c || {});
                b = "function" === a.type(b) ? b() : b, b = "string" === a.type(b) ? b : String(b);
                var e, f;
                if (d.raw || (b = a.terminal.encode(b)), b = a.terminal.overtyping(b), b = a.terminal.from_ansi(b), 
                M.push(Q), !d.raw && (b.length > V || b.match(/\n/))) {
                    var g = a.terminal.split_equal(b, V);
                    for (e = 0, f = g.length; f > e; ++e) "" === g[e] || "\r" === g[e] ? M.push("&nbsp;") : d.raw ? M.push(g[e]) : M.push(a.terminal.format(g[e], {
                        linksNoReferer: da.linksNoReferer
                    }));
                } else d.raw || (b = a.terminal.format(b, {
                    linksNoReferer: da.linksNoReferer
                })), M.push(b);
                M.push(d.finalize);
            } catch (h) {
                M = [], alert("[Internal Exception(draw_line)]:" + q(h) + "\n" + h.stack);
            }
        }
        function z() {
            la.resize(V);
            var b, c = U.empty().detach();
            if (da.outputLimit >= 0) {
                var d = 0 === da.outputLimit ? R.rows() : da.outputLimit;
                b = $.slice($.length - d - 1);
            } else b = $;
            a.each(b, function(a, b) {
                y.apply(null, b);
            }), la.before(c), R.flush();
        }
        function A() {
            if (da.greetings === b) R.echo(R.signature); else if (da.greetings) {
                var a = typeof da.greetings;
                "string" === a ? R.echo(da.greetings) : "function" === a ? da.greetings.call(R, R.echo) : R.error(ea.wrongGreetings);
            }
        }
        function B(b) {
            b = a.terminal.escape_brackets(a.terminal.encode(b, !0));
            var c = la.prompt();
            la.mask() && (b = b.replace(/./g, "*")), "function" == typeof c ? c(function(a) {
                R.echo(a + b);
            }) : R.echo(c + b);
        }
        function C(c, d, e) {
            try {
                K() || (T = a.terminal.splitCommand(c).name, (e && "function" == typeof da.historyFilter && da.historyFilter(c) || !da.historyFilter) && la.history().append(c));
                var f = ka.top();
                if ("exit" === c && da.exit) {
                    var g = ka.size();
                    R.token(), (1 == g && R.token() || g > 1) && (d || B(c), R.pop());
                } else {
                    d || B(c);
                    var h = $.length - 1;
                    if ("clear" === c && da.clear) R.clear(); else {
                        var i = f.interpreter(c, R);
                        i !== b && (h === $.length - 1 ? ($.pop(), i !== !1 && R.echo(i)) : $ = i === !1 ? $.slice(0, h).concat($.slice(h + 1)) : $.slice(0, h).concat([ i ]).concat($.slice(h + 1)), 
                        R.resize());
                    }
                }
            } catch (j) {
                throw v(j, "USER"), R.resume(), j;
            }
        }
        function D() {
            if ("function" == typeof da.onBeforeLogout) try {
                if (da.onBeforeLogout(R) === !1) return;
            } catch (a) {
                throw v(a, "onBeforeLogout"), a;
            }
            if (E(), "function" == typeof da.onAfterLogout) try {
                da.onAfterLogout(R);
            } catch (a) {
                throw v(a, "onAfterlogout"), a;
            }
            R.login(da.login, !0, H);
        }
        function E() {
            var b = R.prefix_name(!0) + "_";
            a.Storage.remove(b + "token"), a.Storage.remove(b + "login");
        }
        function F(b) {
            var c = R.prefix_name() + "_interpreters", d = a.Storage.get(c);
            d = d ? a.parseJSON(d) : [], -1 == a.inArray(b, d) && (d.push(b), a.Storage.set(c, a.json_stringify(d)));
        }
        function G(a) {
            var b = ka.top(), c = R.prefix_name(!0);
            K() || F(c), la.name(c), "function" == typeof b.prompt ? la.prompt(function(a) {
                b.prompt(a, R);
            }) : la.prompt(b.prompt), la.set(""), a || "function" != typeof b.onStart || b.onStart(R);
        }
        function H() {
            G(), A();
            var b = !1;
            if ("function" == typeof da.onInit) {
                ba = function() {
                    b = !0;
                };
                try {
                    da.onInit(R);
                } catch (c) {
                    throw v(c, "OnInit"), c;
                } finally {
                    ba = a.noop, b || R.resume();
                }
            }
        }
        function J(b, c, d) {
            var e = la.get().substring(0, la.position());
            if (e === b) {
                for (var f = new RegExp("^" + a.terminal.escape_regex(c)), g = [], h = d.length; h--; ) f.test(d[h]) && g.push(d[h]);
                if (1 === g.length) R.insert(g[0].replace(f, "") + " "); else if (g.length > 1) if (Z >= 2) B(b), 
                R.echo(g.join("	")), Z = 0; else {
                    var i, j = !1;
                    a: for (i = c.length; i < g[0].length; ++i) {
                        for (h = 1; h < g.length; ++h) if (g[0].charAt(i) !== g[h].charAt(i)) break a;
                        j = !0;
                    }
                    j && R.insert(g[0].slice(0, i).replace(f, ""));
                }
            }
        }
        function K() {
            return aa || la.mask();
        }
        function L(c) {
            var d, e, f = ka.top();
            if ("function" === a.type(f.keydown) && (d = f.keydown(c, R), d !== b)) return d;
            var g;
            if (g = da.completion && "boolean" != a.type(da.completion) && !f.completion ? da.completion : f.completion, 
            R.oneTime(10, function() {
                ha();
            }), "function" === a.type(da.keydown) && (d = da.keydown(c, R), d !== b)) return d;
            if (R.paused()) {
                if (68 === c.which && c.ctrlKey) {
                    if (O.length) {
                        for (e = O.length; e--; ) {
                            var h = O[e];
                            if (4 !== h.readyState) try {
                                h.abort();
                            } catch (i) {
                                R.error(l.ajaxAbortError);
                            }
                        }
                        O = [], R.resume();
                    }
                    return !1;
                }
            } else {
                if (9 !== c.which && (Z = 0), 68 === c.which && c.ctrlKey) return aa || ("" === la.get() ? ka.size() > 1 || da.login !== b ? R.pop("") : (R.resume(), 
                R.echo("")) : R.set_command("")), !1;
                if (76 === c.which && c.ctrlKey) R.clear(); else {
                    if (g && 9 === c.which) {
                        ++Z;
                        var j, k = la.get().substring(0, la.position()), l = k.split(" ");
                        if (1 == l.length) j = l[0]; else for (j = l[l.length - 1], e = l.length - 1; e > 0 && "\\" == l[e - 1][l[e - 1].length - 1]; e--) j = l[e - 1] + " " + j;
                        switch (a.type(g)) {
                          case "function":
                            g(R, j, function(a) {
                                J(k, j, a);
                            });
                            break;

                          case "array":
                            J(k, j, g);
                            break;

                          default:
                            throw new Error(a.terminal.defaults.strings.invalidCompletion);
                        }
                        return !1;
                    }
                    if (86 === c.which && c.ctrlKey) return void R.oneTime(1, function() {
                        w();
                    });
                    if (9 === c.which && c.ctrlKey) {
                        if (P.length() > 1) return R.focus(!1), !1;
                    } else 34 === c.which ? R.scroll(R.height()) : 33 === c.which ? R.scroll(-R.height()) : R.attr({
                        scrollTop: R.attr("scrollHeight")
                    });
                }
            }
        }
        var M = [], Q = 1, R = this;
        if (this.length > 1) return this.each(function() {
            a.fn.terminal.call(a(this), c, a.extend({
                name: R.selector
            }, d));
        });
        if (R.data("terminal")) return R.data("terminal");
        if (0 === R.length) throw 'Sorry, but terminal said that "' + R.selector + '" is not valid selector!';
        var S, T, U, V, W, X, Y, Z = 0, $ = [], _ = P.length(), aa = !1, ba = a.noop, ca = [], da = a.extend({}, a.terminal.defaults, {
            name: R.selector
        }, d || {}), ea = a.terminal.defaults.strings, fa = da.enabled, ga = !1;
        a.extend(R, a.omap({
            clear: function() {
                U.html(""), la.set(""), $ = [];
                try {
                    da.onClear(R);
                } catch (a) {
                    throw v(a, "onClear"), a;
                }
                return R.attr({
                    scrollTop: 0
                }), R;
            },
            export_view: function() {
                if (aa) throw new Exception(ea.notWhileLogin);
                return {
                    prompt: R.get_prompt(),
                    command: R.get_command(),
                    position: la.position(),
                    lines: $.slice(0)
                };
            },
            import_view: function(a) {
                if (aa) throw new Exception(ea.notWhileLogin);
                return R.set_prompt(a.prompt), R.set_command(a.command), la.position(a.position), 
                $ = a.lines, z(), R;
            },
            exec: function(a, b) {
                return ga ? ca.push([ a, b ]) : C(a, b, !0), R;
            },
            login: function(b, c, d, e) {
                if (aa) throw new Error(ea.notWhileLogin);
                if ("function" != typeof b) throw new Error(ea.loginIsNotAFunction);
                if (R.token(!0) && R.login_name(!0)) return "function" == typeof d && d(), R;
                return da.history && la.history().disable(), aa = !0, R.push(function(f) {
                    R.set_mask(!0).push(function(g) {
                        try {
                            b.call(R, f, g, function(b, g) {
                                if (b) {
                                    R.pop().pop(), da.history && la.history().enable();
                                    var h = R.prefix_name(!0) + "_";
                                    a.Storage.set(h + "token", b), a.Storage.set(h + "login", f), aa = !1, "function" == typeof d && d();
                                } else c ? (g || R.error(ea.wrongPasswordTryAgain), R.pop().set_mask(!1)) : (aa = !1, 
                                g || R.error(ea.wrongPassword), R.pop().pop()), "function" == typeof e && e();
                            });
                        } catch (h) {
                            v(h, "USER(authentication)");
                        }
                    }, {
                        prompt: ea.password + ": "
                    });
                }, {
                    prompt: ea.login + ": "
                });
            },
            settings: da,
            commands: function() {
                return ka.top().interpreter;
            },
            setInterpreter: function(b, c) {
                function d() {
                    R.pause(), m(b, c, function(b) {
                        R.resume();
                        var c = ka.top();
                        a.extend(c, b), G(!0);
                    });
                }
                "string" == a.type(b) && c ? R.login(n(b, c), !0, d) : d();
            },
            greetings: function() {
                return A(), R;
            },
            paused: function() {
                return ga;
            },
            pause: function() {
                return ba(), !ga && la && (ga = !0, R.disable(), la.hidden()), R;
            },
            resume: function() {
                if (ga && la) {
                    ga = !1, R.enable(), la.visible();
                    var a = ca;
                    for (ca = []; a.length; ) R.exec.apply(R, a.shift());
                    w();
                }
                return R;
            },
            cols: function() {
                return V;
            },
            rows: function() {
                return W;
            },
            history: function() {
                return la.history();
            },
            next: function() {
                if (1 === P.length()) return R;
                var b = R.offset().top;
                R.height(), R.scrollTop();
                if (p(R)) {
                    P.front().disable();
                    var c = P.rotate().enable(), d = c.offset().top - 50;
                    a("html,body").animate({
                        scrollTop: d
                    }, 500);
                    try {
                        da.onTerminalChange(c);
                    } catch (e) {
                        throw v(e, "onTerminalChange"), e;
                    }
                    return c;
                }
                return R.enable(), a("html,body").animate({
                    scrollTop: b - 50
                }, 500), R;
            },
            focus: function(a, b) {
                return R.oneTime(1, function() {
                    if (1 === P.length()) if (a === !1) try {
                        b || da.onBlur(R) === !1 || R.disable();
                    } catch (c) {
                        throw v(c, "onBlur"), c;
                    } else try {
                        b || da.onFocus(R) === !1 || R.enable();
                    } catch (c) {
                        throw v(c, "onFocus"), c;
                    } else if (a === !1) R.next(); else {
                        var d = P.front();
                        if (d != R && (d.disable(), !b)) try {
                            da.onTerminalChange(R);
                        } catch (c) {
                            throw v(c, "onTerminalChange"), c;
                        }
                        P.set(R), R.enable();
                    }
                }), R;
            },
            enable: function() {
                return V === b && R.resize(), la && (la.enable(), fa = !0), R;
            },
            disable: function() {
                return la && (fa = !1, la.disable()), R;
            },
            enabled: function() {
                return fa;
            },
            signature: function() {
                var a = R.cols(), b = 15 > a ? null : 35 > a ? 0 : 55 > a ? 1 : 64 > a ? 2 : 75 > a ? 3 : 4;
                return null !== b ? N[b].join("\n") + "\n" : "";
            },
            version: function() {
                return I;
            },
            cmd: function() {
                return la;
            },
            get_command: function() {
                return la.get();
            },
            set_command: function(a) {
                return la.set(a), R;
            },
            insert: function(a) {
                if ("string" == typeof a) return la.insert(a), R;
                throw "insert function argument is not a string";
            },
            set_prompt: function(a) {
                return x("prompt", a) && ("function" == typeof a ? la.prompt(function(b) {
                    a(b, R);
                }) : la.prompt(a), ka.top().prompt = a), R;
            },
            get_prompt: function() {
                return ka.top().prompt;
            },
            set_mask: function(a) {
                return la.mask(a), R;
            },
            get_output: function(b) {
                return b ? $ : a.map($, function(a) {
                    return "function" == typeof a[0] ? a[0]() : a[0];
                }).join("\n");
            },
            resize: function(a, b) {
                a && b && (R.width(a), R.height(b)), a = R.width(), b = R.height();
                var c = r(R), d = s(R);
                return (c !== V || d !== W) && (V = c, W = d, z(), "function" != typeof da.onResize || Y === b && X === a || da.onResize(R), 
                (Y !== b || X !== a) && (Y = b, X = a)), R;
            },
            flush: function() {
                try {
                    var b;
                    if (a.each(M, function(c, d) {
                        if (d === Q) b = a("<div></div>"); else if ("function" == typeof d) {
                            b.appendTo(U);
                            try {
                                d(b);
                            } catch (e) {
                                v(e, "USER:echo(finalize)");
                            }
                        } else a("<div/>").html(d).appendTo(b).width("100%");
                    }), da.outputLimit >= 0) {
                        var c = 0 === da.outputLimit ? R.rows() : da.outputLimit, d = U.find("div div");
                        if (d.length > c) {
                            var e = d.slice(0, $.length - c + 1), f = e.parent();
                            e.remove(), f.each(function() {
                                var b = a(this);
                                b.is(":empty") && b.remove();
                            });
                        }
                    }
                    w(), M = [];
                } catch (g) {
                    alert("[Flush] " + q(g) + "\n" + g.stack);
                }
                return R;
            },
            echo: function(b, c) {
                try {
                    b = b || "";
                    var d = a.extend({
                        flush: !0,
                        raw: !1,
                        finalize: a.noop
                    }, c || {});
                    M = [], y(b, d), $.push([ b, d ]), d.flush && R.flush(), ha();
                } catch (e) {
                    alert("[Terminal.echo] " + q(e) + "\n" + e.stack);
                }
                return R;
            },
            error: function(b, c) {
                return R.echo("[[;#f00;]" + a.terminal.escape_brackets(b).replace(/\\$/, "&#92;") + "]", c);
            },
            exception: function(b, c) {
                var d = q(b);
                c && (d = "&#91;" + c + "&#93;: " + d), d && R.error(d, {
                    finalize: function(a) {
                        a.addClass("exception message");
                    }
                }), "string" == typeof b.fileName && (R.pause(), a.get(b.fileName, function(a) {
                    R.resume();
                    var c = b.lineNumber - 1, d = a.split("\n")[c];
                    d && R.error("&#91;" + b.lineNumber + "&#93;: " + d);
                })), b.stack && R.error(b.stack, {
                    finalize: function(a) {
                        a.addClass("exception stack-trace");
                    }
                });
            },
            scroll: function(a) {
                var b;
                return a = Math.round(a), S.prop ? (a > S.prop("scrollTop") && a > 0 && S.prop("scrollTop", 0), 
                b = S.prop("scrollTop"), S.scrollTop(b + a)) : (a > S.attr("scrollTop") && a > 0 && S.attr("scrollTop", 0), 
                b = S.attr("scrollTop"), S.scrollTop(b + a)), R;
            },
            logout: da.login ? function() {
                for (;ka.size() > 1; ) R.pop();
                return R.pop();
            } : function() {
                R.error(ea.loginFunctionMissing);
            },
            token: da.login ? function(b) {
                return a.Storage.get(R.prefix_name(b) + "_token");
            } : a.noop,
            login_name: da.login ? function(b) {
                return a.Storage.get(R.prefix_name(b) + "_login");
            } : a.noop,
            name: function() {
                return ka.top().name;
            },
            prefix_name: function(a) {
                var b = (da.name ? da.name + "_" : "") + _;
                return a && ka.size() > 1 && (b += "_" + ka.map(function(a) {
                    return a.name;
                }).slice(1).join("_")), b;
            },
            push: function(b, c) {
                c = c || {}, c.name = c.name || T, c.prompt = c.prompt || c.name + " ";
                var d = ka.top();
                return d && (d.mask = la.mask()), m(b, c.login, function(d) {
                    if (ka.push(a.extend({}, d, c)), c.login) {
                        var e = a.type(c.login);
                        "function" == e ? R.login(c.login, !1, G, R.pop) : ("string" == a.type(b) && "string" == e || "boolean" == e) && R.login(n(b, c.login), !1, G, R.pop);
                    } else G();
                }), R;
            },
            pop: function(c) {
                c !== b && B(c);
                var d = R.token(!0);
                if (1 == ka.size()) if (da.login) {
                    if (D(), "function" === a.type(da.onExit)) try {
                        da.onExit(R);
                    } catch (e) {
                        throw v(e, "onExit"), e;
                    }
                } else R.error(ea.canExitError); else {
                    d && E();
                    var f = ka.pop();
                    if (G(), "function" === a.type(f.onExit)) try {
                        f.onExit(R);
                    } catch (e) {
                        throw v(e, "onExit"), e;
                    }
                    R.set_mask(ka.top().mask);
                }
                return R;
            },
            level: function() {
                return ka.size();
            },
            reset: function() {
                for (R.clear(); ka.size() > 1; ) ka.pop();
                return H(), R;
            },
            purge: function() {
                var b = R.prefix_name() + "_", c = a.Storage.get(b + "interpreters");
                return a.each(a.parseJSON(c), function(b, c) {
                    a.Storage.remove(c + "_commands"), a.Storage.remove(c + "_token"), a.Storage.remove(c + "_login");
                }), la.purge(), a.Storage.remove(b + "interpreters"), R;
            },
            destroy: function() {
                return la.destroy().remove(), U.remove(), a(document).unbind(".terminal"), a(window).unbind(".terminal"), 
                R.unbind("click, mousewheel"), R.removeData("terminal").removeClass("terminal"), 
                da.width && R.css("width", ""), da.height && R.css("height", ""), R;
            }
        }, function(a, b) {
            return function() {
                try {
                    return b.apply(this, Array.prototype.slice.apply(arguments));
                } catch (c) {
                    throw "exec" !== a && "resume" !== a && v(c, "TERMINAL"), c;
                }
            };
        }));
        var ha = function() {
            var a = u(R);
            return function() {
                a !== u(R) && (R.resize(), a = u(R));
            };
        }();
        if (da.width && R.width(da.width), da.height && R.height(da.height), S = navigator.userAgent.toLowerCase().match(/(webkit)[ \/]([\w.]+)/) || "body" != R[0].tagName.toLowerCase() ? R : a("html"), 
        a(document).bind("ajaxSend.terminal", function(a, b, c) {
            O.push(b);
        }), U = a("<div>").addClass("terminal-output").appendTo(R), R.addClass("terminal"), 
        ("ontouchstart" in window || window.DocumentTouch && document instanceof DocumentTouch) && (R.click(function() {
            R.find("textarea").focus();
        }), R.find("textarea").focus()), da.login && "function" == typeof da.onBeforeLogin) try {
            da.onBeforeLogin(R);
        } catch (ia) {
            throw v(ia, "onBeforeLogin"), ia;
        }
        var ja = da.login;
        "string" != typeof c || "string" != typeof da.login && !da.login || (da.login = n(c, da.login)), 
        P.append(R);
        var ka, la;
        return m(c, ja, function(c) {
            if (ka = new k(a.extend({
                name: da.name,
                prompt: da.prompt,
                greetings: da.greetings
            }, c)), la = a("<div/>").appendTo(R).cmd({
                prompt: da.prompt,
                history: da.history,
                historyFilter: da.historyFilter,
                historySize: da.historySize,
                width: "100%",
                keydown: L,
                keypress: da.keypress ? function(a) {
                    return da.keypress(a, R);
                } : null,
                onCommandChange: function(b) {
                    if ("function" === a.type(da.onCommandChange)) try {
                        da.onCommandChange(b, R);
                    } catch (c) {
                        throw v(c, "onCommandChange"), c;
                    }
                    w();
                },
                commands: C
            }), fa ? R.focus(b, !0) : R.disable(), a(document).bind("click.terminal", function(b) {
                a(b.target).closest(".terminal").hasClass("terminal") || da.onBlur(R) === !1 || R.disable();
            }), R.click(function(a) {
                R.enabled() || R.focus();
            }).mousedown(function(a) {
                2 == a.which && R.insert(t());
            }), da.login ? R.login(da.login, !0, H) : H(), R.is(":visible") && (V = r(R), la.resize(V), 
            W = s(R)), R.oneTime(100, function() {
                a(window).bind("resize.terminal", function() {
                    if (R.is(":visible")) {
                        var a = R.width(), b = R.height();
                        (Y !== b || X !== a) && R.resize();
                    }
                });
            }), a.event.special.mousewheel) {
                var d = !1;
                a(document).bind("keydown.terminal", function(a) {
                    a.shiftKey && (d = !0);
                }).bind("keyup.terminal", function(a) {
                    (a.shiftKey || 16 == a.which) && (d = !1);
                }), R.mousewheel(function(a, b) {
                    d || (b > 0 ? R.scroll(-40) : R.scroll(40));
                });
            }
        }), R.data("terminal", R), R;
    };
}(jQuery), function(a) {
    function b(a) {
        return Object.prototype.toString.call(a).slice(8, -1).toLowerCase();
    }
    function c(a, b) {
        for (var c = []; b > 0; c[--b] = a) ;
        return c.join("");
    }
    var d = function() {
        return d.cache.hasOwnProperty(arguments[0]) || (d.cache[arguments[0]] = d.parse(arguments[0])), 
        d.format.call(null, d.cache[arguments[0]], arguments);
    };
    d.format = function(a, e) {
        var f, g, h, i, j, k, l, m = 1, n = a.length, o = "", p = [];
        for (g = 0; n > g; g++) if (o = b(a[g]), "string" === o) p.push(a[g]); else if ("array" === o) {
            if (i = a[g], i[2]) for (f = e[m], h = 0; h < i[2].length; h++) {
                if (!f.hasOwnProperty(i[2][h])) throw d('[sprintf] property "%s" does not exist', i[2][h]);
                f = f[i[2][h]];
            } else f = i[1] ? e[i[1]] : e[m++];
            if (/[^s]/.test(i[8]) && "number" != b(f)) throw d("[sprintf] expecting number but found %s", b(f));
            switch (i[8]) {
              case "b":
                f = f.toString(2);
                break;

              case "c":
                f = String.fromCharCode(f);
                break;

              case "d":
                f = parseInt(f, 10);
                break;

              case "e":
                f = i[7] ? f.toExponential(i[7]) : f.toExponential();
                break;

              case "f":
                f = i[7] ? parseFloat(f).toFixed(i[7]) : parseFloat(f);
                break;

              case "o":
                f = f.toString(8);
                break;

              case "s":
                f = (f = String(f)) && i[7] ? f.substring(0, i[7]) : f;
                break;

              case "u":
                f >>>= 0;
                break;

              case "x":
                f = f.toString(16);
                break;

              case "X":
                f = f.toString(16).toUpperCase();
            }
            f = /[def]/.test(i[8]) && i[3] && f >= 0 ? "+" + f : f, k = i[4] ? "0" == i[4] ? "0" : i[4].charAt(1) : " ", 
            l = i[6] - String(f).length, j = i[6] ? c(k, l) : "", p.push(i[5] ? f + j : j + f);
        }
        return p.join("");
    }, d.cache = {}, d.parse = function(a) {
        for (var b = a, c = [], d = [], e = 0; b; ) {
            if (null !== (c = /^[^\x25]+/.exec(b))) d.push(c[0]); else if (null !== (c = /^\x25{2}/.exec(b))) d.push("%"); else {
                if (null === (c = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b))) throw "[sprintf] huh?";
                if (c[2]) {
                    e |= 1;
                    var f = [], g = c[2], h = [];
                    if (null === (h = /^([a-z_][a-z_\d]*)/i.exec(g))) throw "[sprintf] huh?";
                    for (f.push(h[1]); "" !== (g = g.substring(h[0].length)); ) if (null !== (h = /^\.([a-z_][a-z_\d]*)/i.exec(g))) f.push(h[1]); else {
                        if (null === (h = /^\[(\d+)\]/.exec(g))) throw "[sprintf] huh?";
                        f.push(h[1]);
                    }
                    c[2] = f;
                } else e |= 2;
                if (3 === e) throw "[sprintf] mixing positional and named placeholders is not (yet) supported";
                d.push(c);
            }
            b = b.substring(c[0].length);
        }
        return d;
    };
    var e = function(a, b, c) {
        return c = b.slice(0), c.splice(0, 0, a), d.apply(null, c);
    };
    a.sprintf = d, a.vsprintf = e;
}("undefined" != typeof exports ? exports : window), function(a, b) {
    "use strict";
    function c(a, b) {
        var c;
        if ("string" == typeof a && "string" == typeof b) return localStorage[a] = b, !0;
        if ("object" == typeof a && "undefined" == typeof b) {
            for (c in a) a.hasOwnProperty(c) && (localStorage[c] = a[c]);
            return !0;
        }
        return !1;
    }
    function d(a, b) {
        var c, d, e;
        if (c = new Date(), c.setTime(c.getTime() + 31536e6), d = "; expires=" + c.toGMTString(), 
        "string" == typeof a && "string" == typeof b) return document.cookie = a + "=" + b + d + "; path=/", 
        !0;
        if ("object" == typeof a && "undefined" == typeof b) {
            for (e in a) a.hasOwnProperty(e) && (document.cookie = e + "=" + a[e] + d + "; path=/");
            return !0;
        }
        return !1;
    }
    function e(a) {
        return localStorage[a];
    }
    function f(a) {
        var b, c, d, e;
        for (b = a + "=", c = document.cookie.split(";"), d = 0; d < c.length; d++) {
            for (e = c[d]; " " === e.charAt(0); ) e = e.substring(1, e.length);
            if (0 === e.indexOf(b)) return e.substring(b.length, e.length);
        }
        return null;
    }
    function g(a) {
        return delete localStorage[a];
    }
    function h(a) {
        return d(a, "", -1);
    }
    function i(a, b) {
        var c = [], d = a.length;
        if (b > d) return [ a ];
        for (var e = 0; d > e; e += b) c.push(a.substring(e, e + b));
        return c;
    }
    function j(b) {
        var c = b ? [ b ] : [], d = 0;
        a.extend(this, {
            get: function() {
                return c;
            },
            rotate: function() {
                return 1 === c.length ? c[0] : (d === c.length - 1 ? d = 0 : ++d, c[d]);
            },
            length: function() {
                return c.length;
            },
            set: function(a) {
                for (var b = c.length; b--; ) if (c[b] === a) return void (d = b);
                this.append(a);
            },
            front: function() {
                return c[d];
            },
            append: function(a) {
                c.push(a);
            }
        });
    }
    function k(b) {
        var c = b ? [ b ] : [];
        a.extend(this, {
            map: function(b) {
                return a.map(c, b);
            },
            size: function() {
                return c.length;
            },
            pop: function() {
                if (0 === c.length) return null;
                var a = c[c.length - 1];
                return c = c.slice(0, c.length - 1), a;
            },
            push: function(a) {
                return c = c.concat([ a ]), a;
            },
            top: function() {
                return c.length > 0 ? c[c.length - 1] : null;
            }
        });
    }
    function l(b, c) {
        var d = !0, e = "";
        "string" == typeof b && "" !== b && (e = b + "_"), e += "commands";
        var f = a.Storage.get(e);
        f = f ? a.parseJSON(f) : [];
        var g = f.length - 1;
        a.extend(this, {
            append: function(b) {
                d && f[f.length - 1] !== b && (f.push(b), c && f.length > c && (f = f.slice(-c)), 
                g = f.length - 1, a.Storage.set(e, a.json_stringify(f)));
            },
            data: function() {
                return f;
            },
            reset: function() {
                g = f.length - 1;
            },
            last: function() {
                return f[length - 1];
            },
            end: function() {
                return g === f.length - 1;
            },
            position: function() {
                return g;
            },
            current: function() {
                return f[g];
            },
            next: function() {
                return g < f.length - 1 && ++g, -1 !== g ? f[g] : void 0;
            },
            previous: function() {
                var a = g;
                return g > 0 && --g, -1 !== a ? f[g] : void 0;
            },
            clear: function() {
                f = [], this.purge();
            },
            enabled: function() {
                return d;
            },
            enable: function() {
                d = !0;
            },
            purge: function() {
                a.Storage.remove(e);
            },
            disable: function() {
                d = !1;
            }
        });
    }
    function m(b) {
        return a("<div>" + a.terminal.strip(b) + "</div>").text().length;
    }
    function n() {
        var a = !1, c = "animation", d = "", e = "Webkit Moz O ms Khtml".split(" "), f = "", g = document.createElement("div");
        if (g.style.animationName && (a = !0), a === !1) for (var h = 0; h < e.length; h++) if (g.style[e[h] + "AnimationName"] !== b) {
            f = e[h], c = f + "Animation", d = "-" + f.toLowerCase() + "-", a = !0;
            break;
        }
        return a;
    }
    function o(a, b) {
        var c = a.replace(/^\s+|\s+$/g, "").split(/(\s+)/), d = a.replace(/^[^\s]+\s*/, "");
        return {
            name: c[0],
            args: b(d),
            rest: d
        };
    }
    function p(b) {
        var c = a(window).scrollTop(), d = c + a(window).height(), e = a(b).offset().top, f = e + a(b).height();
        return f >= c && d >= e;
    }
    function q() {
        var b = a('<div class="terminal"><div class="cmd"><span>&nbsp;</span></div></div>').appendTo("body"), c = b.find("span"), d = {
            width: c.width(),
            height: c.outerHeight()
        };
        return b.remove(), d;
    }
    function r(a) {
        var b = q().width, c = Math.floor(a.width() / b);
        if (u(a)) {
            var d = 20, e = a.innerWidth() - a.width();
            c -= Math.ceil((d - e / 2) / (b - 1));
        }
        return c;
    }
    function s(a) {
        return Math.floor(a.height() / q().height);
    }
    function t() {
        if (window.getSelection || document.getSelection) {
            var a = (window.getSelection || document.getSelection)();
            return a.text ? a.text : a.toString();
        }
        return document.selection ? document.selection.createRange().text : void 0;
    }
    function u(a) {
        return a.get(0).scrollHeight > a.innerHeight();
    }
    a.omap = function(b, c) {
        var d = {};
        return a.each(b, function(a, e) {
            d[a] = c.call(b, a, e);
        }), d;
    };
    var v = "undefined" != typeof window.localStorage;
    a.extend({
        Storage: {
            set: v ? c : d,
            get: v ? e : f,
            remove: v ? g : h
        }
    }), jQuery.fn.extend({
        everyTime: function(a, b, c, d, e) {
            return this.each(function() {
                jQuery.timer.add(this, a, b, c, d, e);
            });
        },
        oneTime: function(a, b, c) {
            return this.each(function() {
                jQuery.timer.add(this, a, b, c, 1);
            });
        },
        stopTime: function(a, b) {
            return this.each(function() {
                jQuery.timer.remove(this, a, b);
            });
        }
    }), jQuery.extend({
        timer: {
            guid: 1,
            global: {},
            regex: /^([0-9]+)\s*(.*s)?$/,
            powers: {
                ms: 1,
                cs: 10,
                ds: 100,
                s: 1e3,
                das: 1e4,
                hs: 1e5,
                ks: 1e6
            },
            timeParse: function(a) {
                if (a === b || null === a) return null;
                var c = this.regex.exec(jQuery.trim(a.toString()));
                if (c[2]) {
                    var d = parseInt(c[1], 10), e = this.powers[c[2]] || 1;
                    return d * e;
                }
                return a;
            },
            add: function(a, b, c, d, e, f) {
                var g = 0;
                if (jQuery.isFunction(c) && (e || (e = d), d = c, c = b), b = jQuery.timer.timeParse(b), 
                !("number" != typeof b || isNaN(b) || 0 >= b)) {
                    e && e.constructor !== Number && (f = !!e, e = 0), e = e || 0, f = f || !1, a.$timers || (a.$timers = {}), 
                    a.$timers[c] || (a.$timers[c] = {}), d.$timerID = d.$timerID || this.guid++;
                    var h = function() {
                        f && h.inProgress || (h.inProgress = !0, (++g > e && 0 !== e || d.call(a, g) === !1) && jQuery.timer.remove(a, c, d), 
                        h.inProgress = !1);
                    };
                    h.$timerID = d.$timerID, a.$timers[c][d.$timerID] || (a.$timers[c][d.$timerID] = window.setInterval(h, b)), 
                    this.global[c] || (this.global[c] = []), this.global[c].push(a);
                }
            },
            remove: function(a, b, c) {
                var d, e = a.$timers;
                if (e) {
                    if (b) {
                        if (e[b]) {
                            if (c) c.$timerID && (window.clearInterval(e[b][c.$timerID]), delete e[b][c.$timerID]); else for (var f in e[b]) e[b].hasOwnProperty(f) && (window.clearInterval(e[b][f]), 
                            delete e[b][f]);
                            for (d in e[b]) if (e[b].hasOwnProperty(d)) break;
                            d || (d = null, delete e[b]);
                        }
                    } else for (var g in e) e.hasOwnProperty(g) && this.remove(a, g, c);
                    for (d in e) if (e.hasOwnProperty(d)) break;
                    d || (a.$timers = null);
                }
            }
        }
    }), /(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) && jQuery(window).one("unload", function() {
        var a = jQuery.timer.global;
        for (var b in a) if (a.hasOwnProperty(b)) for (var c = a[b], d = c.length; --d; ) jQuery.timer.remove(c[d], b);
    }), function(a) {
        if (String.prototype.split.toString().match(/\[native/)) {
            var b, c = String.prototype.split, d = /()??/.exec("")[1] === a;
            return b = function(b, e, f) {
                if ("[object RegExp]" !== Object.prototype.toString.call(e)) return c.call(b, e, f);
                var g, h, i, j, k = [], l = (e.ignoreCase ? "i" : "") + (e.multiline ? "m" : "") + (e.extended ? "x" : "") + (e.sticky ? "y" : ""), m = 0;
                for (e = new RegExp(e.source, l + "g"), b += "", d || (g = new RegExp("^" + e.source + "$(?!\\s)", l)), 
                f = f === a ? -1 >>> 0 : f >>> 0; (h = e.exec(b)) && (i = h.index + h[0].length, 
                !(i > m && (k.push(b.slice(m, h.index)), !d && h.length > 1 && h[0].replace(g, function() {
                    for (var b = 1; b < arguments.length - 2; b++) arguments[b] === a && (h[b] = a);
                }), h.length > 1 && h.index < b.length && Array.prototype.push.apply(k, h.slice(1)), 
                j = h[0].length, m = i, k.length >= f))); ) e.lastIndex === h.index && e.lastIndex++;
                return m === b.length ? (j || !e.test("")) && k.push("") : k.push(b.slice(m)), k.length > f ? k.slice(0, f) : k;
            }, String.prototype.split = function(a, c) {
                return b(this, a, c);
            }, b;
        }
    }(), a.json_stringify = function(c, d) {
        var e, f = "";
        d = d === b ? 1 : d;
        var g = typeof c;
        switch (g) {
          case "function":
            f += c;
            break;

          case "boolean":
            f += c ? "true" : "false";
            break;

          case "object":
            if (null === c) f += "null"; else if (c instanceof Array) {
                f += "[";
                var h = c.length;
                for (e = 0; h - 1 > e; ++e) f += a.json_stringify(c[e], d + 1);
                f += a.json_stringify(c[h - 1], d + 1) + "]";
            } else {
                f += "{";
                for (var i in c) c.hasOwnProperty(i) && (f += '"' + i + '":' + a.json_stringify(c[i], d + 1));
                f += "}";
            }
            break;

          case "string":
            var j = c, k = {
                "\\\\": "\\\\",
                '"': '\\"',
                "/": "\\/",
                "\\n": "\\n",
                "\\r": "\\r",
                "\\t": "\\t"
            };
            for (e in k) k.hasOwnProperty(e) && (j = j.replace(new RegExp(e, "g"), k[e]));
            f += '"' + j + '"';
            break;

          case "number":
            f += String(c);
        }
        return f += d > 1 ? "," : "", 1 === d && (f = f.replace(/,([\]}])/g, "$1")), f.replace(/([\[{]),/g, "$1");
    }, a.fn.cmd = function(c) {
        function d(a) {
            K.toggleClass("inverted");
        }
        function e() {
            w = "(reverse-i-search)`" + B + "': ", N();
        }
        function f() {
            w = v, A = !1, C = null, B = "";
        }
        function g(a) {
            var b, c, d = y.data(), f = d.length;
            if (a && C > 0 && (f -= C), B.length > 0) for (var g = B.length; g > 0; g--) {
                c = B.substring(0, g).replace(/([.*+{}\[\]?])/g, "\\$1"), b = new RegExp(c);
                for (var h = f; h--; ) if (b.test(d[h])) return C = d.length - h, H = 0, p.set(d[h], !0), 
                M(), void (B.length !== g && (B = B.substring(0, g), e()));
            }
            B = "";
        }
        function h() {
            var a = p.width(), b = K.innerWidth();
            s = Math.floor(a / b);
        }
        function j(a) {
            var b = a.substring(0, s - u), c = a.substring(s - u);
            return [ b ].concat(i(c, s));
        }
        function k() {
            r.focus(), p.oneTime(1, function() {
                p.insert(r.val()), r.blur().val("");
            });
        }
        function o(a) {
            var d, h, i;
            if ("function" == typeof c.keydown && (d = c.keydown(a), d !== b)) return d;
            if (I) {
                if (38 === a.which || 80 === a.which && a.ctrlKey || (O = !0), !A || 35 !== a.which && 36 !== a.which && 37 !== a.which && 38 !== a.which && 39 !== a.which && 40 !== a.which && 13 !== a.which && 27 !== a.which) {
                    if (a.altKey) return 68 === a.which ? (p.set(E.slice(0, H) + E.slice(H).replace(/[^ ]+ |[^ ]+$/, ""), !0), 
                    !1) : !0;
                    if (13 === a.keyCode) if (a.shiftKey) p.insert("\n"); else {
                        y && E && !D && ("function" == typeof c.historyFilter && c.historyFilter(E) || !c.historyFilter) && y.append(E);
                        var j = E;
                        y.reset(), p.set(""), c.commands && c.commands(j), "function" == typeof w && N();
                    } else if (8 === a.which) A ? (B = B.slice(0, -1), e()) : "" !== E && H > 0 && (E = E.slice(0, H - 1) + E.slice(H, E.length), 
                    --H, M()); else if (67 === a.which && a.ctrlKey && a.shiftKey) F = t(); else if (86 === a.which && a.ctrlKey && a.shiftKey) "" !== F && p.insert(F); else if (9 !== a.which || a.ctrlKey || a.altKey) {
                        if (46 === a.which) return "" !== E && H < E.length && (E = E.slice(0, H) + E.slice(H + 1, E.length), 
                        M()), !0;
                        if (y && 38 === a.which || 80 === a.which && a.ctrlKey) O ? (L = E, p.set(y.current())) : p.set(y.previous()), 
                        O = !1; else if (y && 40 === a.which || 78 === a.which && a.ctrlKey) p.set(y.end() ? L : y.next()); else if (37 === a.which || 66 === a.which && a.ctrlKey) if (a.ctrlKey && 66 !== a.which) {
                            i = H - 1, h = 0, " " === E[i] && --i;
                            for (var l = i; l > 0; --l) {
                                if (" " === E[l] && " " !== E[l + 1]) {
                                    h = l + 1;
                                    break;
                                }
                                if ("\n" === E[l] && "\n" !== E[l + 1]) {
                                    h = l;
                                    break;
                                }
                            }
                            p.position(h);
                        } else H > 0 && (--H, M()); else if (82 === a.which && a.ctrlKey) A ? g(!0) : (v = w, 
                        e(), L = E, E = "", M(), A = !0); else if (71 == a.which && a.ctrlKey) A && (w = v, 
                        N(), E = L, M(), A = !1, B = ""); else if (39 === a.which || 70 === a.which && a.ctrlKey) if (a.ctrlKey && 70 !== a.which) {
                            " " === E[H] && ++H;
                            var m = /\S[\n\s]{2,}|[\n\s]+\S?/, n = E.slice(H).match(m);
                            !n || n[0].match(/^\s+$/) ? H = E.length : " " !== n[0][0] ? H += n.index + 1 : (H += n.index + n[0].length - 1, 
                            " " !== n[0][n[0].length - 1] && --H), M();
                        } else H < E.length && (++H, M()); else {
                            if (123 === a.which) return !0;
                            if (36 === a.which) p.position(0); else if (35 === a.which) p.position(E.length); else {
                                if (a.shiftKey && 45 == a.which) return k(), !0;
                                if (!a.ctrlKey && !a.metaKey) return !0;
                                if (192 === a.which) return !0;
                                if (a.metaKey) {
                                    if (82 === a.which) return !0;
                                    if (76 === a.which) return !0;
                                }
                                if (a.shiftKey) {
                                    if (84 === a.which) return !0;
                                } else {
                                    if (81 === a.which) {
                                        if ("" !== E && 0 !== H) {
                                            var q = E.slice(0, H), r = E.slice(H + 1), s = q.match(/([^ ]+ *$)/);
                                            H = q.length - s[0].length, G = q.slice(H), E = q.slice(0, H) + r, M();
                                        }
                                        return !1;
                                    }
                                    if (72 === a.which) return "" !== E && H > 0 && (E = E.slice(0, --H), H < E.length - 1 && (E += E.slice(H)), 
                                    M()), !1;
                                    if (65 === a.which) p.position(0); else if (69 === a.which) p.position(E.length); else {
                                        if (88 === a.which || 67 === a.which || 84 === a.which) return !0;
                                        if (89 === a.which) "" !== G && p.insert(G); else {
                                            if (86 === a.which) return k(), !0;
                                            if (75 === a.which) 0 === H ? (G = E, p.set("")) : H !== E.length && (G = E.slice(H), 
                                            p.set(E.slice(0, H))); else if (85 === a.which) "" !== E && 0 !== H && (G = E.slice(0, H), 
                                            p.set(E.slice(H, E.length)), p.position(0)); else if (17 === a.which) return !1;
                                        }
                                    }
                                }
                            }
                        }
                    } else p.insert("	");
                } else f(), N(), 27 === a.which && (E = ""), M(), o.call(this, a);
                return !1;
            }
        }
        var p = this, q = p.data("cmd");
        if (q) return q;
        p.addClass("cmd"), p.append('<span class="prompt"></span><span></span><span class="cursor">&nbsp;</span><span></span>');
        var r = a("<textarea/>").addClass("clipboard").appendTo(p);
        c.width && p.width(c.width);
        var s, u, v, w, x, y, z, A = !1, B = "", C = null, D = c.mask || !1, E = "", F = "", G = "", H = 0, I = c.enabled, J = c.historySize || 60, K = p.find(".cursor");
        z = n() ? function(a) {
            a ? K.addClass("blink") : K.removeClass("blink");
        } : function(a) {
            a && !I ? (K.addClass("inverted"), p.everyTime(500, "blink", d)) : I && (p.stopTime("blink", d), 
            K.removeClass("inverted"));
        };
        var L, M = function(b) {
            function c(b, c) {
                var d = b.length;
                if (c === d) g.html(a.terminal.encode(b, !0)), K.html("&nbsp;"), h.html(""); else if (0 === c) g.html(""), 
                K.html(a.terminal.encode(b.slice(0, 1), !0)), h.html(a.terminal.encode(b.slice(1), !0)); else {
                    var e = a.terminal.encode(b.slice(0, c), !0);
                    g.html(e);
                    var f = b.slice(c, c + 1);
                    K.html(" " === f ? "&nbsp;" : a.terminal.encode(f, !0)), c === b.length - 1 ? h.html("") : h.html(a.terminal.encode(b.slice(c + 1), !0));
                }
            }
            function d(b) {
                return "<div>" + a.terminal.encode(b, !0) + "</div>";
            }
            function e(b) {
                var c = h;
                a.each(b, function(b, e) {
                    c = a(d(e)).insertAfter(c).addClass("clear");
                });
            }
            function f(b) {
                a.each(b, function(a, b) {
                    g.before(d(b));
                });
            }
            var g = K.prev(), h = K.next();
            return function() {
                var k, l, m = D ? E.replace(/./g, "*") : E;
                if (b.find("div").remove(), g.html(""), m.length > s - u - 1 || m.match(/\n/)) {
                    var n, o = m.match(/\t/g), p = o ? 3 * o.length : 0;
                    if (o && (m = m.replace(/\t/g, "\x00\x00\x00\x00")), m.match(/\n/)) {
                        var q = m.split("\n");
                        for (l = s - u - 1, k = 0; k < q.length - 1; ++k) q[k] += " ";
                        for (q[0].length > l ? (n = [ q[0].substring(0, l) ], n = n.concat(i(q[0].substring(l), s))) : n = [ q[0] ], 
                        k = 1; k < q.length; ++k) q[k].length > s ? n = n.concat(i(q[k], s)) : n.push(q[k]);
                    } else n = j(m);
                    if (o && (n = a.map(n, function(a) {
                        return a.replace(/\x00\x00\x00\x00/g, "	");
                    })), l = n[0].length, 0 === l && 1 === n.length) ; else if (l > H) c(n[0], H), e(n.slice(1)); else if (H === l) g.before(d(n[0])), 
                    c(n[1], 0), e(n.slice(2)); else {
                        var r = n.length;
                        if (l > H) c(n[0], H), e(n.slice(1)); else if (H === l) g.before(d(n[0])), c(n[1], 0), 
                        e(n.slice(2)); else {
                            var t = n.slice(-1)[0], v = m.length - H, w = t.length, x = 0;
                            if (w >= v) f(n.slice(0, -1)), x = w === v ? 0 : w - v, c(t, x + p); else if (3 === r) g.before("<div>" + a.terminal.encode(n[0], !0) + "</div>"), 
                            c(n[1], H - l - 1), h.after('<div class="clear">' + a.terminal.encode(n[2], !0) + "</div>"); else {
                                var y, z;
                                for (x = H, k = 0; k < n.length; ++k) {
                                    var A = n[k].length;
                                    if (!(x > A)) break;
                                    x -= A;
                                }
                                z = n[k], y = k, x === z.length && (x = 0, z = n[++y]), c(z, x), f(n.slice(0, y)), 
                                e(n.slice(y + 1));
                            }
                        }
                    }
                } else "" === m ? (g.html(""), K.html("&nbsp;"), h.html("")) : c(m, H);
            };
        }(p), N = function() {
            function b(b) {
                u = m(b), c.html(a.terminal.format(a.terminal.encode(b)));
            }
            var c = p.find(".prompt");
            return function() {
                switch (typeof w) {
                  case "string":
                    b(w);
                    break;

                  case "function":
                    w(b);
                }
            };
        }(), O = !0;
        a.extend(p, {
            name: function(a) {
                if (a !== b) {
                    x = a;
                    var c = y && y.enabled() || !y;
                    return y = new l(a, J), c || y.disable(), p;
                }
                return x;
            },
            purge: function() {
                return y.clear(), p;
            },
            history: function() {
                return y;
            },
            set: function(a, d) {
                return a !== b && (E = a, d || (H = E.length), M(), "function" == typeof c.onCommandChange && c.onCommandChange(E)), 
                p;
            },
            insert: function(a, b) {
                return H === E.length ? E += a : E = 0 === H ? a + E : E.slice(0, H) + a + E.slice(H), 
                b || (H += a.length), M(), "function" == typeof c.onCommandChange && c.onCommandChange(E), 
                p;
            },
            get: function() {
                return E;
            },
            commands: function(a) {
                return a ? (c.commands = a, p) : a;
            },
            destroy: function() {
                return a(document.documentElement || window).unbind(".cmd"), p.stopTime("blink", d), 
                p.find(".cursor").next().remove().end().prev().remove().end().remove(), p.find(".prompt, .clipboard").remove(), 
                p.removeClass("cmd").removeData("cmd"), p;
            },
            prompt: function(a) {
                if (a === b) return w;
                if ("string" != typeof a && "function" != typeof a) throw "prompt must be a function or string";
                return w = a, N(), M(), p;
            },
            kill_text: function() {
                return G;
            },
            position: function(a) {
                return "number" == typeof a ? (H = 0 > a ? 0 : a > E.length ? E.length : a, M(), 
                p) : H;
            },
            visible: function() {
                var a = p.visible;
                return function() {
                    a.apply(p, []), M(), N();
                };
            }(),
            show: function() {
                var a = p.show;
                return function() {
                    a.apply(p, []), M(), N();
                };
            }(),
            resize: function(a) {
                return a ? s = a : h(), M(), p;
            },
            enable: function() {
                return I = !0, z(!0), p;
            },
            isenabled: function() {
                return I;
            },
            disable: function() {
                return I = !1, z(!1), p;
            },
            mask: function(a) {
                return "boolean" == typeof a ? (D = a, M(), p) : D;
            }
        }), p.name(c.name || c.prompt || ""), w = c.prompt || "> ", N(), (c.enabled === b || c.enabled === !0) && p.enable();
        return a(document.documentElement || window).bind("keypress.cmd", function(d) {
            var f;
            if (d.ctrlKey && 99 === d.which) return !0;
            if (A || "function" != typeof c.keypress || (f = c.keypress(d)), f !== b && !f) return f;
            if (I) {
                if (a.inArray(d.which, [ 38, 13, 0, 8 ]) > -1 && 123 !== d.keyCode && (38 !== d.which || !d.shiftKey)) return !1;
                if (!d.ctrlKey && (!d.altKey || 100 !== d.which) || d.altKey) return A ? (B += String.fromCharCode(d.which), 
                g(), e()) : p.insert(String.fromCharCode(d.which)), !1;
            }
        }).bind("keydown.cmd", o), p.data("cmd", p), p;
    };
    var w = [ "black", "silver", "gray", "white", "maroon", "red", "purple", "fuchsia", "green", "lime", "olive", "yellow", "navy", "blue", "teal", "aqua", "aliceblue", "antiquewhite", "aqua", "aquamarine", "azure", "beige", "bisque", "black", "blanchedalmond", "blue", "blueviolet", "brown", "burlywood", "cadetblue", "chartreuse", "chocolate", "coral", "cornflowerblue", "cornsilk", "crimson", "cyan", "darkblue", "darkcyan", "darkgoldenrod", "darkgray", "darkgreen", "darkgrey", "darkkhaki", "darkmagenta", "darkolivegreen", "darkorange", "darkorchid", "darkred", "darksalmon", "darkseagreen", "darkslateblue", "darkslategray", "darkslategrey", "darkturquoise", "darkviolet", "deeppink", "deepskyblue", "dimgray", "dimgrey", "dodgerblue", "firebrick", "floralwhite", "forestgreen", "fuchsia", "gainsboro", "ghostwhite", "gold", "goldenrod", "gray", "green", "greenyellow", "grey", "honeydew", "hotpink", "indianred", "indigo", "ivory", "khaki", "lavender", "lavenderblush", "lawngreen", "lemonchiffon", "lightblue", "lightcoral", "lightcyan", "lightgoldenrodyellow", "lightgray", "lightgreen", "lightgrey", "lightpink", "lightsalmon", "lightseagreen", "lightskyblue", "lightslategray", "lightslategrey", "lightsteelblue", "lightyellow", "lime", "limegreen", "linen", "magenta", "maroon", "mediumaquamarine", "mediumblue", "mediumorchid", "mediumpurple", "mediumseagreen", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "mintcream", "mistyrose", "moccasin", "navajowhite", "navy", "oldlace", "olive", "olivedrab", "orange", "orangered", "orchid", "palegoldenrod", "palegreen", "paleturquoise", "palevioletred", "papayawhip", "peachpuff", "peru", "pink", "plum", "powderblue", "purple", "red", "rosybrown", "royalblue", "saddlebrown", "salmon", "sandybrown", "seagreen", "seashell", "sienna", "silver", "skyblue", "slateblue", "slategray", "slategrey", "snow", "springgreen", "steelblue", "tan", "teal", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "whitesmoke", "yellow", "yellowgreen" ], x = /(\[\[[gbiuso]*;[^;]*;[^\]]*\](?:[^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?)/i, y = /\[\[([gbiuso]*);([^;]*);([^;\]]*);?([^;\]]*);?([^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/gi, z = /\[\[([gbiuso]*;[^;\]]*;[^;\]]*(?:;|[^\]()]*);?[^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/gi, A = /^\[\[([gbiuso]*;[^;\]]*;[^;\]]*(?:;|[^\]()]*);?[^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]$/gi, B = /^#([0-9a-f]{3}|[0-9a-f]{6})$/i, C = /\bhttps?:\/\/(?:(?!&[^;]+;)[^\s"'<>)])+\b/g, D = /((([^<>('")[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,})))/g, E = /('[^']*'|"(\\"|[^"])*"|\/(\\\/|[^\/])+\/[gimy]*|(\\ |[^ ])+|[\w-]+)/g, F = /(\[\[[gbiuso]*;[^;]*;[^\]]*\])/i, G = /\[\[[gbiuso]*;[^;]*;[^\]]*\]?$/i;
    a.terminal = {
        valid_color: function(b) {
            return b.match(B) || -1 !== a.inArray(b.toLowerCase(), w);
        },
        escape_regex: function(a) {
            var b = /([\^\$\[\]\(\)\+\*\.\|])/g;
            return a.replace(b, "\\$1");
        },
        have_formatting: function(a) {
            return a.match(z);
        },
        is_formatting: function(a) {
            return a.match(A);
        },
        format_split: function(a) {
            return a.split(x);
        },
        split_equal: function(a, b) {
            for (var c = !1, d = !1, e = "", f = [], g = a.replace(z, function(a, b, c) {
                var d = b.match(/;/g).length;
                return d = 2 == d ? ";;" : 3 == d ? ";" : "", "[[" + b + d + c.replace(/\\\]/g, "&#93;").replace(/\n/g, "\\n") + "]" + c + "]";
            }).split(/\n/g), h = 0, i = g.length; i > h; ++h) if ("" !== g[h]) for (var j = g[h], k = 0, l = 0, m = 0, n = j.length; n > m; ++m) {
                if ("[" === j[m] && "[" === j[m + 1]) c = !0; else if (c && "]" === j[m]) d ? (c = !1, 
                d = !1) : d = !0; else if (c && d || !c) {
                    if ("&" === j[m]) {
                        var o = j.substring(m).match(/^(&[^;]+;)/);
                        if (!o) throw "Unclosed html entity in line " + (h + 1) + " at char " + (m + 1);
                        m += o[1].length - 2, m === n - 1 && f.push(p + o[1]);
                        continue;
                    }
                    "]" === j[m] && "\\" === j[m - 1] ? --l : ++l;
                }
                if (l === b || m === n - 1) {
                    var p = j.substring(k, m + 1);
                    e && (p = e + p, p.match("]") && (e = "")), k = m + 1, l = 0;
                    var q = p.match(z);
                    if (q) {
                        var r = q[q.length - 1];
                        if ("]" !== r[r.length - 1]) e = r.match(F)[1], p += "]"; else if (p.match(G)) {
                            var s = p.length;
                            s - r[r.length - 1].length;
                            p = p.replace(G, ""), e = r.match(F)[1];
                        }
                    }
                    f.push(p);
                }
            } else f.push("");
            return f;
        },
        encode: function(a, b) {
            return a = b ? a.replace(/&(?![^=]+=)/g, "&amp;") : a.replace(/&(?!#[0-9]+;|[a-zA-Z]+;|[^= "]+=[^=])/g, "&amp;"), 
            a.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/ /g, "&nbsp;").replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;");
        },
        format: function(b, c) {
            var d = a.extend({}, {
                linksNoReferrer: !1
            }, c || {});
            if ("string" == typeof b) {
                var e = a.terminal.format_split(b);
                return e && e.length > 1 && (b = a.map(e, function(b) {
                    return "" === b ? b : "[" === b.substring(0, 1) ? b.replace(y, function(b, c, d, e, f, g, h) {
                        if ("" === h) return "";
                        h = h.replace(/\\]/g, "]");
                        var i = "";
                        -1 !== c.indexOf("b") && (i += "font-weight:bold;");
                        var j = [];
                        -1 !== c.indexOf("u") && j.push("underline"), -1 !== c.indexOf("s") && j.push("line-through"), 
                        -1 !== c.indexOf("o") && j.push("overline"), j.length && (i += "text-decoration:" + j.join(" ") + ";"), 
                        -1 !== c.indexOf("i") && (i += "font-style:italic;"), a.terminal.valid_color(d) && (i += "color:" + d + ";", 
                        -1 !== c.indexOf("g") && (i += "text-shadow:0 0 5px " + d + ";")), a.terminal.valid_color(e) && (i += "background-color:" + e);
                        var k;
                        k = "" === g ? h : g.replace(/&#93;/g, "]");
                        var l = '<span style="' + i + '"' + ("" !== f ? ' class="' + f + '"' : "") + ' data-text="' + k.replace('"', "&quote;") + '">' + h + "</span>";
                        return l;
                    }) : "<span>" + b + "</span>";
                }).join("")), a.map(b.split(/(<\/?span[^>]*>)/g), function(a) {
                    return a.match(/span/) ? a : a.replace(C, function(a) {
                        var b = a.match(/\.$/);
                        return a = a.replace(/\.$/, ""), '<a target="_blank" ' + (d.linksNoReferer ? ' rel="noreferrer" ' : "") + 'href="' + a + '">' + a + "</a>" + (b ? "." : "");
                    }).replace(D, '<a href="mailto:$1">$1</a>');
                }).join("").replace(/<span><br\/?><\/span>/g, "<br/>");
            }
            return "";
        },
        escape_brackets: function(a) {
            return a.replace(/\[/g, "&#91;").replace(/\]/g, "&#93;");
        },
        strip: function(a) {
            return a.replace(y, "$6");
        },
        active: function() {
            return P.front();
        },
        overtyping: function(a) {
            return a.replace(/((?:_\x08.|.\x08_)+)/g, function(a, b) {
                return "[[u;;]" + a.replace(/_x08|\x08_|_\u0008|\u0008_/g, "") + "]";
            }).replace(/((?:.\x08.)+)/g, function(a, b) {
                return "[[b;#fff;]" + a.replace(/(.)(?:\x08|\u0008)(.)/g, function(a, b, c) {
                    return c;
                }) + "]";
            });
        },
        ansi_colors: {
            normal: {
                black: "#000",
                red: "#A00",
                green: "#008400",
                yellow: "#A50",
                blue: "#00A",
                magenta: "#A0A",
                cyan: "#0AA",
                white: "#AAA"
            },
            faited: {
                black: "#000",
                red: "#640000",
                green: "#006100",
                yellow: "#737300",
                blue: "#000087",
                magenta: "#650065",
                cyan: "#008787",
                white: "#818181"
            },
            bold: {
                black: "#000",
                red: "#F55",
                green: "#44D544",
                yellow: "#FF5",
                blue: "#55F",
                magenta: "#F5F",
                cyan: "#5FF",
                white: "#FFF"
            },
            palette: [ "#000000", "#AA0000", "#00AA00", "#AA5500", "#0000AA", "#AA00AA", "#00AAAA", "#AAAAAA", "#555555", "#FF5555", "#55FF55", "#FFFF55", "#5555FF", "#FF55FF", "#55FFFF", "#FFFFFF", "#000000", "#00005F", "#000087", "#0000AF", "#0000D7", "#0000FF", "#005F00", "#005F5F", "#005F87", "#005FAF", "#005FD7", "#005FFF", "#008700", "#00875F", "#008787", "#0087AF", "#0087D7", "#00AF00", "#00AF5F", "#00AF87", "#00AFAF", "#00AFD7", "#00AFFF", "#00D700", "#00D75F", "#00D787", "#00D7AF", "#00D7D7", "#00D7FF", "#00FF00", "#00FF5F", "#00FF87", "#00FFAF", "#00FFD7", "#00FFFF", "#5F0000", "#5F005F", "#5F0087", "#5F00AF", "#5F00D7", "#5F00FF", "#5F5F00", "#5F5F5F", "#5F5F87", "#5F5FAF", "#5F5FD7", "#5F5FFF", "#5F8700", "#5F875F", "#5F8787", "#5F87AF", "#5F87D7", "#5F87FF", "#5FAF00", "#5FAF5F", "#5FAF87", "#5FAFAF", "#5FAFD7", "#5FAFFF", "#5FD700", "#5FD75F", "#5FD787", "#5FD7AF", "#5FD7D7", "#5FD7FF", "#5FFF00", "#5FFF5F", "#5FFF87", "#5FFFAF", "#5FFFD7", "#5FFFFF", "#870000", "#87005F", "#870087", "#8700AF", "#8700D7", "#8700FF", "#875F00", "#875F5F", "#875F87", "#875FAF", "#875FD7", "#875FFF", "#878700", "#87875F", "#878787", "#8787AF", "#8787D7", "#8787FF", "#87AF00", "#87AF5F", "#87AF87", "#87AFAF", "#87AFD7", "#87AFFF", "#87D700", "#87D75F", "#87D787", "#87D7AF", "#87D7D7", "#87D7FF", "#87FF00", "#87FF5F", "#87FF87", "#87FFAF", "#87FFD7", "#87FFFF", "#AF0000", "#AF005F", "#AF0087", "#AF00AF", "#AF00D7", "#AF00FF", "#AF5F00", "#AF5F5F", "#AF5F87", "#AF5FAF", "#AF5FD7", "#AF5FFF", "#AF8700", "#AF875F", "#AF8787", "#AF87AF", "#AF87D7", "#AF87FF", "#AFAF00", "#AFAF5F", "#AFAF87", "#AFAFAF", "#AFAFD7", "#AFAFFF", "#AFD700", "#AFD75F", "#AFD787", "#AFD7AF", "#AFD7D7", "#AFD7FF", "#AFFF00", "#AFFF5F", "#AFFF87", "#AFFFAF", "#AFFFD7", "#AFFFFF", "#D70000", "#D7005F", "#D70087", "#D700AF", "#D700D7", "#D700FF", "#D75F00", "#D75F5F", "#D75F87", "#D75FAF", "#D75FD7", "#D75FFF", "#D78700", "#D7875F", "#D78787", "#D787AF", "#D787D7", "#D787FF", "#D7AF00", "#D7AF5F", "#D7AF87", "#D7AFAF", "#D7AFD7", "#D7AFFF", "#D7D700", "#D7D75F", "#D7D787", "#D7D7AF", "#D7D7D7", "#D7D7FF", "#D7FF00", "#D7FF5F", "#D7FF87", "#D7FFAF", "#D7FFD7", "#D7FFFF", "#FF0000", "#FF005F", "#FF0087", "#FF00AF", "#FF00D7", "#FF00FF", "#FF5F00", "#FF5F5F", "#FF5F87", "#FF5FAF", "#FF5FD7", "#FF5FFF", "#FF8700", "#FF875F", "#FF8787", "#FF87AF", "#FF87D7", "#FF87FF", "#FFAF00", "#FFAF5F", "#FFAF87", "#FFAFAF", "#FFAFD7", "#FFAFFF", "#FFD700", "#FFD75F", "#FFD787", "#FFD7AF", "#FFD7D7", "#FFD7FF", "#FFFF00", "#FFFF5F", "#FFFF87", "#FFFFAF", "#FFFFD7", "#FFFFFF", "#080808", "#121212", "#1C1C1C", "#262626", "#303030", "#3A3A3A", "#444444", "#4E4E4E", "#585858", "#626262", "#6C6C6C", "#767676", "#808080", "#8A8A8A", "#949494", "#9E9E9E", "#A8A8A8", "#B2B2B2", "#BCBCBC", "#C6C6C6", "#D0D0D0", "#DADADA", "#E4E4E4", "#EEEEEE" ]
        },
        from_ansi: function() {
            function b(b) {
                var e, f = b.split(";"), g = !1, h = !1, i = !1, j = [], k = "", l = "", m = !1, n = !1, o = !1, p = a.terminal.ansi_colors.palette;
                for (var q in f) {
                    switch (e = parseInt(f[q], 10)) {
                      case 1:
                        j.push("b"), i = !0, g = !1;
                        break;

                      case 4:
                        j.push("u");
                        break;

                      case 3:
                        j.push("i");
                        break;

                      case 5:
                        o = !0;
                        break;

                      case 38:
                        m = !0;
                        break;

                      case 48:
                        n = !0;
                        break;

                      case 2:
                        g = !0, i = !1;
                        break;

                      case 7:
                        h = !0;
                        break;

                      default:
                        m && o && p[e - 1] ? k = p[e - 1] : c[e] && (k = c[e]), n && o && p[e - 1] ? l = p[e - 1] : d[e] && (l = d[e]);
                    }
                    5 !== e && (o = !1);
                }
                if (h) if (k && l) {
                    var r = l;
                    l = k, k = r;
                } else k = "black", l = "white";
                var s, t;
                return s = t = i ? a.terminal.ansi_colors.bold : g ? a.terminal.ansi_colors.faited : a.terminal.ansi_colors.normal, 
                [ j.join(""), m ? k : s[k], n ? l : t[l] ];
            }
            var c = {
                30: "black",
                31: "red",
                32: "green",
                33: "yellow",
                34: "blue",
                35: "magenta",
                36: "cyan",
                37: "white",
                39: "white"
            }, d = {
                40: "black",
                41: "red",
                42: "green",
                43: "yellow",
                44: "blue",
                45: "magenta",
                46: "cyan",
                47: "white",
                49: "black"
            };
            return function(a) {
                var c = a.split(/(\x1B\[[0-9;]*[A-Za-z])/g);
                if (1 == c.length) return a;
                var d = [];
                c.length > 3 && "[0m" == c.slice(0, 3).join("") && (c = c.slice(3));
                for (var e, f, g, h, i = !1, j = 0; j < c.length; ++j) if (h = c[j].match(/^\x1B\[([0-9;]*)([A-Za-z])$/)) switch (h[2]) {
                  case "m":
                    if ("" === h[1]) continue;
                    "0" !== h[1] && (g = b(h[1])), i ? (d.push("]"), "0" == h[1] ? (i = !1, e = f = "") : (g[1] = g[1] || e, 
                    g[2] = g[2] || f, d.push("[[" + g.join(";") + "]"), g[1] && (e = g[1]), g[2] && (f = g[2]))) : "0" != h[1] && (i = !0, 
                    d.push("[[" + g.join(";") + "]"), g[1] && (e = g[1]), g[2] && (f = g[2]));
                } else d.push(c[j]);
                return i && d.push("]"), d.join("");
            };
        }(),
        parseArguments: function(b) {
            return a.map(b.match(E) || [], function(a) {
                if ("'" === a[0] && "'" === a[a.length - 1]) return a.replace(/^'|'$/g, "");
                if ('"' === a[0] && '"' === a[a.length - 1]) return a = a.replace(/^"|"$/g, "").replace(/\\([" ])/g, "$1"), 
                a.replace(/\\\\|\\t|\\n/g, function(a) {
                    return "t" === a[1] ? "	" : "n" === a[1] ? "\n" : "\\";
                }).replace(/\\x([0-9a-f]+)/gi, function(a, b) {
                    return String.fromCharCode(parseInt(b, 16));
                }).replace(/\\0([0-7]+)/g, function(a, b) {
                    return String.fromCharCode(parseInt(b, 8));
                });
                if (a.match(/^\/(\\\/|[^\/])+\/[gimy]*$/)) {
                    var b = a.match(/^\/([^\/]+)\/([^\/]*)$/);
                    return new RegExp(b[1], b[2]);
                }
                return a.match(/^-?[0-9]+$/) ? parseInt(a, 10) : a.match(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/) ? parseFloat(a) : a.replace(/\\ /g, " ");
            });
        },
        splitArguments: function(b) {
            return a.map(b.match(E) || [], function(a) {
                return "'" === a[0] && "'" === a[a.length - 1] ? a.replace(/^'|'$/g, "") : '"' === a[0] && '"' === a[a.length - 1] ? a.replace(/^"|"$/g, "").replace(/\\([" ])/g, "$1") : "/" === a[0] && "/" == a[a.length - 1] ? a : a.replace(/\\ /g, " ");
            });
        },
        parseCommand: function(b) {
            return o(b, a.terminal.parseArguments);
        },
        splitCommand: function(b) {
            return o(b, a.terminal.splitArguments);
        },
        test: function() {
            function b(a, b) {
                c.echo(b + " &#91;" + (a ? "[[b;#44D544;]PASS]" : "[[b;#FF5555;]FAIL]") + "&#93;");
            }
            var c = a.terminal.active();
            if (!c) {
                c = a("body").terminal(a.noop).css("margin", 0);
                var d = (c.outerHeight() - c.height(), a(window));
                d.resize(function() {
                    c.css("height", a(window).height() - 20);
                }).resize();
            }
            c.echo("Testing...");
            var e = 'name "foo bar" baz /^asd [x]/ str\\ str 10 1e10', f = a.terminal.splitCommand(e);
            b("name" === f.name && "foo bar" === f.args[0] && "baz" === f.args[1] && "/^asd [x]/" === f.args[2] && "str str" === f.args[3] && "10" === f.args[4] && "1e10" === f.args[5], "$.terminal.splitCommand"), 
            f = a.terminal.parseCommand(e), b("name" === f.name && "foo bar" === f.args[0] && "baz" === f.args[1] && "regexp" === a.type(f.args[2]) && "^asd [x]" === f.args[2].source && "str str" === f.args[3] && 10 === f.args[4] && 1e10 === f.args[5], "$.terminal.parseCommand"), 
            e = "[2;31;46mFoo[1;3;4;32;45mBar[0m[7mBaz", b("[[;#640000;#008787]Foo][[biu;#44D544;#F5F]Bar][[;#000;#AAA]Baz]" === a.terminal.from_ansi(e), "$.terminal.from_ansi"), 
            e = "[[biugs;#fff;#000]Foo][[i;;;foo]Bar][[ous;;]Baz]", c.echo("$.terminal.format"), 
            b('<span style="font-weight:bold;text-decoration:underline line-through;font-style:italic;color:#fff;text-shadow:0 0 5px #fff;background-color:#000" data-text="Foo">Foo</span><span style="font-style:italic;" class="foo" data-text="Bar">Bar</span><span style="text-decoration:underline line-through overline;" data-text="Baz">Baz</span>' === a.terminal.format(e), "	formatting"), 
            e = "http://terminal.jcubic.pl/examples.php https://www.google.com/?q=jquery%20terminal", 
            b('<a target="_blank" href="http://terminal.jcubic.pl/examples.php">http://terminal.jcubic.pl/examples.php</a> <a target="_blank" href="https://www.google.com/?q=jquery%20terminal">https://www.google.com/?q=jquery%20terminal</a>' === a.terminal.format(e), "	urls"), 
            e = "foo@bar.com baz.quux@example.com", b('<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:baz.quux@example.com">baz.quux@example.com</a>' === a.terminal.format(e), "	emails"), 
            e = "-_-[[biugs;#fff;#000]Foo]-_-[[i;;;foo]Bar]-_-[[ous;;]Baz]-_-", b("-_-Foo-_-Bar-_-Baz-_-" === a.terminal.strip(e), "$.terminal.strip"), 
            e = "[[bui;#fff;]Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus] est [[b;;#f00]consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam] non magna quis [[i;;]tortor malesuada aliquam] eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus [[ub;#fff;]felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat], ac mattis enim.", 
            c.echo("$.terminal.split_equal");
            for (var g = [ 10, 40, 60, 400 ], h = g.length; h--; ) {
                for (var i = a.terminal.split_equal(e, g[h]), j = !0, k = 0; k < i.length; ++k) if (a.terminal.strip(i[k]).length > g[h]) {
                    j = !1;
                    break;
                }
                b(j, "	split " + g[h]);
            }
        }
    }, a.fn.visible = function() {
        return this.css("visibility", "visible");
    }, a.fn.hidden = function() {
        return this.css("visibility", "hidden");
    };
    var H = {};
    a.jrpc = function(b, c, d, e, f) {
        H[b] = H[b] || 0;
        var g = a.json_stringify({
            jsonrpc: "2.0",
            method: c,
            params: d,
            id: ++H[b]
        });
        return a.ajax({
            url: b,
            data: g,
            success: function(b, c, d) {
                var g = d.getResponseHeader("Content-Type");
                if (!g.match(/application\/json/)) {
                    if (!console || !console.warn) throw new Error("WARN: Response Content-Type is not application/json");
                    console.warn("Response Content-Type is not application/json");
                }
                var h;
                try {
                    h = a.parseJSON(b);
                } catch (i) {
                    if (!f) throw new Error("Invalid JSON");
                    return void f(d, "Invalid JSON", i);
                }
                e(h, c, d);
            },
            error: f,
            contentType: "application/json",
            dataType: "text",
            async: !0,
            cache: !1,
            type: "POST"
        });
    };
    var I = "0.8.8", J = !I.match(/^\{\{/), K = "Copyright (c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>", L = J ? " version " + I : " ", M = new RegExp(" {" + L.length + "}$"), N = [ [ "jQuery Terminal", "(c) 2011-2013 jcubic" ], [ "jQuery Terminal Emulator" + (J ? " v. " + I : ""), K.replace(/ *<.*>/, "") ], [ "jQuery Terminal Emulator" + (J ? L : ""), K.replace(/^Copyright /, "") ], [ "      _______                 ________                        __", "     / / _  /_ ____________ _/__  ___/______________  _____  / /", " __ / / // / // / _  / _/ // / / / _  / _/     / /  \\/ / _ \\/ /", "/  / / // / // / ___/ // // / / / ___/ // / / / / /\\  / // / /__", "\\___/____ \\\\__/____/_/ \\__ / /_/____/_//_/ /_/ /_/  \\/\\__\\_\\___/", "         \\/          /____/                                   ".replace(M, " ") + L, K ], [ "      __ _____                     ________                              __", "     / // _  /__ __ _____ ___ __ _/__  ___/__ ___ ______ __ __  __ ___  / /", " __ / // // // // // _  // _// // / / // _  // _//     // //  \\/ // _ \\/ /", "/  / // // // // // ___// / / // / / // ___// / / / / // // /\\  // // / /__", "\\___//____ \\\\___//____//_/ _\\_  / /_//____//_/ /_/ /_//_//_/ /_/ \\__\\_\\___/", "          \\/              /____/                                          ".replace(M, "") + L, K ] ];
    a.terminal.defaults = {
        prompt: "> ",
        history: !0,
        exit: !0,
        clear: !0,
        enabled: !0,
        historySize: 60,
        checkArity: !0,
        exceptionHandler: null,
        cancelableAjax: !0,
        processArguments: !0,
        linksNoReferrer: !1,
        login: null,
        outputLimit: -1,
        onAjaxError: null,
        onRPCError: null,
        completion: !1,
        historyFilter: null,
        onInit: a.noop,
        onClear: a.noop,
        onBlur: a.noop,
        onFocus: a.noop,
        onTerminalChange: a.noop,
        onExit: a.noop,
        keypress: a.noop,
        keydown: a.noop,
        strings: {
            wrongPasswordTryAgain: "Wrong password try again!",
            wrongPassword: "Wrong password!",
            ajaxAbortError: "Error while aborting ajax call!",
            wrongArity: "Wrong number of arguments. Function '%s' expect %s got %s!",
            commandNotFound: "Command '%s' Not Found!",
            oneRPCWithIgnore: "You can use only one rpc with ignoreSystemDescribe",
            oneInterpreterFunction: "You can't use more then one function (rpc with ignoreSystemDescribe is count as one)",
            loginFunctionMissing: "You don't have login function",
            noTokenError: "Access denied (no token)",
            serverResponse: "Server reponse is",
            wrongGreetings: "Wrong value of greetings parameter",
            notWhileLogin: "You can't call that function while in login",
            loginIsNotAFunction: "Authenticate must be a function",
            canExitError: "You can't exit from main interpeter",
            invalidCompletion: "Invalid completion",
            login: "login",
            password: "password"
        }
    };
    var O = [], P = new j();
    a.fn.terminal = function(c, d) {
        function e(b) {
            return "function" == typeof da.processArguments ? o(b, da.processArguments) : da.processArguments ? a.terminal.parseCommand(b) : a.terminal.splitCommand(b);
        }
        function f(b) {
            "string" == typeof b ? R.echo(b) : b instanceof Array ? R.echo(a.map(b, function(b) {
                return a.json_stringify(b);
            }).join(" ")) : "object" == typeof b ? R.echo(a.json_stringify(b)) : R.echo(b);
        }
        function g(a) {
            "function" == typeof da.onRPCError ? da.onRPCError.call(R, a) : R.error("&#91;RPC&#93; " + a.message);
        }
        function h(b) {
            var c = function(c, d) {
                R.pause(), a.jrpc(b, c, d, function(a) {
                    a.error ? g(a.error) : "function" == typeof da.processRPCResponse ? da.processRPCResponse.call(R, a.result) : f(a.result), 
                    R.resume();
                }, j);
            };
            return function(a, b) {
                if ("" !== a) if (a = e(a), da.login && "help" !== a.name) {
                    var d = b.token();
                    d ? c(a.name, [ d ].concat(a.args)) : b.error("&#91;AUTH&#93; " + ea.noTokenError);
                } else c(a.name, a.args);
            };
        }
        function i(c, d, f) {
            return function(g, h) {
                if ("" !== g) {
                    var j = e(g), k = c[j.name], l = a.type(k);
                    if ("function" === l) {
                        if (!d || k.length === j.args.length) return k.apply(R, j.args);
                        R.error("&#91;Arity&#93; " + sprintf(ea.wrongArity, j.name, k.length, j.args.length));
                    } else if ("object" === l || "string" === l) {
                        var m = [];
                        "object" === l && (m = Object.keys(k), k = i(k, d)), h.push(k, {
                            prompt: j.name + "> ",
                            name: j.name,
                            completion: "object" === l ? function(a, b, c) {
                                c(m);
                            } : b
                        });
                    } else "function" === a.type(f) ? f(g, R) : "function" === a.type(da.onCommandNotFound) ? da.onCommandNotFound(g, R) : h.error(sprintf(ea.commandNotFound, j.name));
                }
            };
        }
        function j(a, b, c) {
            R.resume(), "function" == typeof da.onAjaxError ? da.onAjaxError.call(R, a, b, c) : "abort" !== b && R.error("&#91;AJAX&#93; " + b + " - " + ea.serverResponse + ": \n" + a.responseText);
        }
        function l(b, c, d) {
            a.jrpc(b, "system.describe", [], function(e) {
                if (e.procs) {
                    var h = {};
                    a.each(e.procs, function(d, e) {
                        h[e.name] = function() {
                            var d = c && "help" != e.name, h = Array.prototype.slice.call(arguments), i = h.length + (d ? 1 : 0);
                            da.checkArity && e.params && e.params.length !== i ? R.error("&#91;Arity&#93; " + sprintf(ea.wrongArity, e.name, e.params.length, i)) : (R.pause(), 
                            d && (h = [ R.token(!0) ].concat(h)), a.jrpc(b, e.name, h, function(a) {
                                a.error ? g(a.error) : f(a.result), R.resume();
                            }, j));
                        };
                    }), d(h);
                } else d(null);
            }, function() {
                d(null);
            });
        }
        function m(b, c, d) {
            d = d || a.noop;
            var e, f, g = a.type(b), j = {}, k = 0;
            if ("array" === g) {
                var m = {};
                !function n(b, d) {
                    if (b.length) {
                        var e = b[0], g = b.slice(1), i = a.type(e);
                        "string" === i ? (k++, R.pause(), da.ignoreSystemDescribe ? (1 === k ? f = h(e) : R.error(ea.oneRPCWithIgnore), 
                        n(g, d)) : l(e, c, function(b) {
                            b && a.extend(m, b), R.resume(), n(g, d);
                        })) : "function" === i ? f ? R.error(ea.oneInterpreterFunction) : f = e : "object" === i && (a.extend(m, e), 
                        n(g, d));
                    } else d();
                }(b, function() {
                    e = Object.keys(m), j.interpreter = i(m, !1, f), j.completion = function(a, b, c) {
                        c(e);
                    }, d(j);
                });
            } else if ("string" === g) da.ignoreSystemDescribe ? d({
                interpreter: h(b),
                completion: da.completion
            }) : (R.pause(), l(b, c, function(a) {
                if (a) {
                    var c = Object.keys(a);
                    j.interpreter = i(a, !1), j.completion = function(a, b, d) {
                        d(c);
                    };
                } else j.interpreter = h(b), j.completion = da.completion;
                R.resume(), d(j);
            })); else if ("object" === g) e = Object.keys(b), j.interpreter = i(b, da.checkArity), 
            j.completion = function(a, b, c) {
                c(e);
            }, d(j); else {
                if ("undefined" === g) b = a.noop; else if ("function" !== g) throw g + " is invalid interpreter value";
                d({
                    interpreter: b,
                    completion: da.completion
                });
            }
        }
        function n(b, c) {
            var d = "boolean" === a.type(c) ? "login" : c;
            return function(c, e, f, g) {
                R.pause(), a.jrpc(b, d, [ c, e ], function(a) {
                    R.resume(), f(!a.error && a.result ? a.result : null);
                }, j);
            };
        }
        function q(a) {
            return "string" == typeof a ? a : "string" == typeof a.fileName ? a.fileName + ": " + a.message : a.message;
        }
        function v(a, b) {
            "function" == typeof da.exceptionHandler ? da.exceptionHandler.call(R, a) : R.exception(a, b);
        }
        function w() {
            var a = S.prop ? S.prop("scrollHeight") : S.attr("scrollHeight");
            S.scrollTop(a);
        }
        function x(a, b) {
            try {
                if ("function" == typeof b) b(function() {}); else if ("string" != typeof b) {
                    var c = a + " must be string or function";
                    throw c;
                }
            } catch (d) {
                return v(d, a.toUpperCase()), !1;
            }
            return !0;
        }
        function y(b, c) {
            try {
                var d = a.extend({
                    raw: !1,
                    finalize: a.noop
                }, c || {});
                b = "function" === a.type(b) ? b() : b, b = "string" === a.type(b) ? b : String(b);
                var e, f;
                if (d.raw || (b = a.terminal.encode(b)), b = a.terminal.overtyping(b), b = a.terminal.from_ansi(b), 
                M.push(Q), !d.raw && (b.length > V || b.match(/\n/))) {
                    var g = a.terminal.split_equal(b, V);
                    for (e = 0, f = g.length; f > e; ++e) "" === g[e] || "\r" === g[e] ? M.push("&nbsp;") : d.raw ? M.push(g[e]) : M.push(a.terminal.format(g[e], {
                        linksNoReferer: da.linksNoReferer
                    }));
                } else d.raw || (b = a.terminal.format(b, {
                    linksNoReferer: da.linksNoReferer
                })), M.push(b);
                M.push(d.finalize);
            } catch (h) {
                M = [], alert("[Internal Exception(draw_line)]:" + q(h) + "\n" + h.stack);
            }
        }
        function z() {
            la.resize(V);
            var b, c = U.empty().detach();
            if (da.outputLimit >= 0) {
                var d = 0 === da.outputLimit ? R.rows() : da.outputLimit;
                b = $.slice($.length - d - 1);
            } else b = $;
            a.each(b, function(a, b) {
                y.apply(null, b);
            }), la.before(c), R.flush();
        }
        function A() {
            if (da.greetings === b) R.echo(R.signature); else if (da.greetings) {
                var a = typeof da.greetings;
                "string" === a ? R.echo(da.greetings) : "function" === a ? da.greetings.call(R, R.echo) : R.error(ea.wrongGreetings);
            }
        }
        function B(b) {
            b = a.terminal.escape_brackets(a.terminal.encode(b, !0));
            var c = la.prompt();
            la.mask() && (b = b.replace(/./g, "*")), "function" == typeof c ? c(function(a) {
                R.echo(a + b);
            }) : R.echo(c + b);
        }
        function C(c, d, e) {
            try {
                K() || (T = a.terminal.splitCommand(c).name, (e && "function" == typeof da.historyFilter && da.historyFilter(c) || !da.historyFilter) && la.history().append(c));
                var f = ka.top();
                if ("exit" === c && da.exit) {
                    var g = ka.size();
                    R.token(), (1 == g && R.token() || g > 1) && (d || B(c), R.pop());
                } else {
                    d || B(c);
                    var h = $.length - 1;
                    if ("clear" === c && da.clear) R.clear(); else {
                        var i = f.interpreter(c, R);
                        i !== b && (h === $.length - 1 ? ($.pop(), i !== !1 && R.echo(i)) : $ = i === !1 ? $.slice(0, h).concat($.slice(h + 1)) : $.slice(0, h).concat([ i ]).concat($.slice(h + 1)), 
                        R.resize());
                    }
                }
            } catch (j) {
                throw v(j, "USER"), R.resume(), j;
            }
        }
        function D() {
            if ("function" == typeof da.onBeforeLogout) try {
                if (da.onBeforeLogout(R) === !1) return;
            } catch (a) {
                throw v(a, "onBeforeLogout"), a;
            }
            if (E(), "function" == typeof da.onAfterLogout) try {
                da.onAfterLogout(R);
            } catch (a) {
                throw v(a, "onAfterlogout"), a;
            }
            R.login(da.login, !0, H);
        }
        function E() {
            var b = R.prefix_name(!0) + "_";
            a.Storage.remove(b + "token"), a.Storage.remove(b + "login");
        }
        function F(b) {
            var c = R.prefix_name() + "_interpreters", d = a.Storage.get(c);
            d = d ? a.parseJSON(d) : [], -1 == a.inArray(b, d) && (d.push(b), a.Storage.set(c, a.json_stringify(d)));
        }
        function G(a) {
            var b = ka.top(), c = R.prefix_name(!0);
            K() || F(c), la.name(c), "function" == typeof b.prompt ? la.prompt(function(a) {
                b.prompt(a, R);
            }) : la.prompt(b.prompt), la.set(""), a || "function" != typeof b.onStart || b.onStart(R);
        }
        function H() {
            G(), A();
            var b = !1;
            if ("function" == typeof da.onInit) {
                ba = function() {
                    b = !0;
                };
                try {
                    da.onInit(R);
                } catch (c) {
                    throw v(c, "OnInit"), c;
                } finally {
                    ba = a.noop, b || R.resume();
                }
            }
        }
        function J(b, c, d) {
            var e = la.get().substring(0, la.position());
            if (e === b) {
                for (var f = new RegExp("^" + a.terminal.escape_regex(c)), g = [], h = d.length; h--; ) f.test(d[h]) && g.push(d[h]);
                if (1 === g.length) R.insert(g[0].replace(f, "") + " "); else if (g.length > 1) if (Z >= 2) B(b), 
                R.echo(g.join("	")), Z = 0; else {
                    var i, j = !1;
                    a: for (i = c.length; i < g[0].length; ++i) {
                        for (h = 1; h < g.length; ++h) if (g[0].charAt(i) !== g[h].charAt(i)) break a;
                        j = !0;
                    }
                    j && R.insert(g[0].slice(0, i).replace(f, ""));
                }
            }
        }
        function K() {
            return aa || la.mask();
        }
        function L(c) {
            var d, e, f = ka.top();
            if ("function" === a.type(f.keydown) && (d = f.keydown(c, R), d !== b)) return d;
            var g;
            if (g = da.completion && "boolean" != a.type(da.completion) && !f.completion ? da.completion : f.completion, 
            R.oneTime(10, function() {
                ha();
            }), "function" === a.type(da.keydown) && (d = da.keydown(c, R), d !== b)) return d;
            if (R.paused()) {
                if (68 === c.which && c.ctrlKey) {
                    if (O.length) {
                        for (e = O.length; e--; ) {
                            var h = O[e];
                            if (4 !== h.readyState) try {
                                h.abort();
                            } catch (i) {
                                R.error(l.ajaxAbortError);
                            }
                        }
                        O = [], R.resume();
                    }
                    return !1;
                }
            } else {
                if (9 !== c.which && (Z = 0), 68 === c.which && c.ctrlKey) return aa || ("" === la.get() ? ka.size() > 1 || da.login !== b ? R.pop("") : (R.resume(), 
                R.echo("")) : R.set_command("")), !1;
                if (76 === c.which && c.ctrlKey) R.clear(); else {
                    if (g && 9 === c.which) {
                        ++Z;
                        var j, k = la.get().substring(0, la.position()), l = k.split(" ");
                        if (1 == l.length) j = l[0]; else for (j = l[l.length - 1], e = l.length - 1; e > 0 && "\\" == l[e - 1][l[e - 1].length - 1]; e--) j = l[e - 1] + " " + j;
                        switch (a.type(g)) {
                          case "function":
                            g(R, j, function(a) {
                                J(k, j, a);
                            });
                            break;

                          case "array":
                            J(k, j, g);
                            break;

                          default:
                            throw new Error(a.terminal.defaults.strings.invalidCompletion);
                        }
                        return !1;
                    }
                    if (86 === c.which && c.ctrlKey) return void R.oneTime(1, function() {
                        w();
                    });
                    if (9 === c.which && c.ctrlKey) {
                        if (P.length() > 1) return R.focus(!1), !1;
                    } else 34 === c.which ? R.scroll(R.height()) : 33 === c.which ? R.scroll(-R.height()) : R.attr({
                        scrollTop: R.attr("scrollHeight")
                    });
                }
            }
        }
        var M = [], Q = 1, R = this;
        if (this.length > 1) return this.each(function() {
            a.fn.terminal.call(a(this), c, a.extend({
                name: R.selector
            }, d));
        });
        if (R.data("terminal")) return R.data("terminal");
        if (0 === R.length) throw 'Sorry, but terminal said that "' + R.selector + '" is not valid selector!';
        var S, T, U, V, W, X, Y, Z = 0, $ = [], _ = P.length(), aa = !1, ba = a.noop, ca = [], da = a.extend({}, a.terminal.defaults, {
            name: R.selector
        }, d || {}), ea = a.terminal.defaults.strings, fa = da.enabled, ga = !1;
        a.extend(R, a.omap({
            clear: function() {
                U.html(""), la.set(""), $ = [];
                try {
                    da.onClear(R);
                } catch (a) {
                    throw v(a, "onClear"), a;
                }
                return R.attr({
                    scrollTop: 0
                }), R;
            },
            export_view: function() {
                if (aa) throw new Exception(ea.notWhileLogin);
                return {
                    prompt: R.get_prompt(),
                    command: R.get_command(),
                    position: la.position(),
                    lines: $.slice(0)
                };
            },
            import_view: function(a) {
                if (aa) throw new Exception(ea.notWhileLogin);
                return R.set_prompt(a.prompt), R.set_command(a.command), la.position(a.position), 
                $ = a.lines, z(), R;
            },
            exec: function(a, b) {
                return ga ? ca.push([ a, b ]) : C(a, b, !0), R;
            },
            login: function(b, c, d, e) {
                if (aa) throw new Error(ea.notWhileLogin);
                if ("function" != typeof b) throw new Error(ea.loginIsNotAFunction);
                if (R.token(!0) && R.login_name(!0)) return "function" == typeof d && d(), R;
                return da.history && la.history().disable(), aa = !0, R.push(function(f) {
                    R.set_mask(!0).push(function(g) {
                        try {
                            b.call(R, f, g, function(b, g) {
                                if (b) {
                                    R.pop().pop(), da.history && la.history().enable();
                                    var h = R.prefix_name(!0) + "_";
                                    a.Storage.set(h + "token", b), a.Storage.set(h + "login", f), aa = !1, "function" == typeof d && d();
                                } else c ? (g || R.error(ea.wrongPasswordTryAgain), R.pop().set_mask(!1)) : (aa = !1, 
                                g || R.error(ea.wrongPassword), R.pop().pop()), "function" == typeof e && e();
                            });
                        } catch (h) {
                            v(h, "USER(authentication)");
                        }
                    }, {
                        prompt: ea.password + ": "
                    });
                }, {
                    prompt: ea.login + ": "
                });
            },
            settings: da,
            commands: function() {
                return ka.top().interpreter;
            },
            setInterpreter: function(b, c) {
                function d() {
                    R.pause(), m(b, c, function(b) {
                        R.resume();
                        var c = ka.top();
                        a.extend(c, b), G(!0);
                    });
                }
                "string" == a.type(b) && c ? R.login(n(b, c), !0, d) : d();
            },
            greetings: function() {
                return A(), R;
            },
            paused: function() {
                return ga;
            },
            pause: function() {
                return ba(), !ga && la && (ga = !0, R.disable(), la.hidden()), R;
            },
            resume: function() {
                if (ga && la) {
                    ga = !1, R.enable(), la.visible();
                    var a = ca;
                    for (ca = []; a.length; ) R.exec.apply(R, a.shift());
                    w();
                }
                return R;
            },
            cols: function() {
                return V;
            },
            rows: function() {
                return W;
            },
            history: function() {
                return la.history();
            },
            next: function() {
                if (1 === P.length()) return R;
                var b = R.offset().top;
                R.height(), R.scrollTop();
                if (p(R)) {
                    P.front().disable();
                    var c = P.rotate().enable(), d = c.offset().top - 50;
                    a("html,body").animate({
                        scrollTop: d
                    }, 500);
                    try {
                        da.onTerminalChange(c);
                    } catch (e) {
                        throw v(e, "onTerminalChange"), e;
                    }
                    return c;
                }
                return R.enable(), a("html,body").animate({
                    scrollTop: b - 50
                }, 500), R;
            },
            focus: function(a, b) {
                return R.oneTime(1, function() {
                    if (1 === P.length()) if (a === !1) try {
                        b || da.onBlur(R) === !1 || R.disable();
                    } catch (c) {
                        throw v(c, "onBlur"), c;
                    } else try {
                        b || da.onFocus(R) === !1 || R.enable();
                    } catch (c) {
                        throw v(c, "onFocus"), c;
                    } else if (a === !1) R.next(); else {
                        var d = P.front();
                        if (d != R && (d.disable(), !b)) try {
                            da.onTerminalChange(R);
                        } catch (c) {
                            throw v(c, "onTerminalChange"), c;
                        }
                        P.set(R), R.enable();
                    }
                }), R;
            },
            enable: function() {
                return V === b && R.resize(), la && (la.enable(), fa = !0), R;
            },
            disable: function() {
                return la && (fa = !1, la.disable()), R;
            },
            enabled: function() {
                return fa;
            },
            signature: function() {
                var a = R.cols(), b = 15 > a ? null : 35 > a ? 0 : 55 > a ? 1 : 64 > a ? 2 : 75 > a ? 3 : 4;
                return null !== b ? N[b].join("\n") + "\n" : "";
            },
            version: function() {
                return I;
            },
            cmd: function() {
                return la;
            },
            get_command: function() {
                return la.get();
            },
            set_command: function(a) {
                return la.set(a), R;
            },
            insert: function(a) {
                if ("string" == typeof a) return la.insert(a), R;
                throw "insert function argument is not a string";
            },
            set_prompt: function(a) {
                return x("prompt", a) && ("function" == typeof a ? la.prompt(function(b) {
                    a(b, R);
                }) : la.prompt(a), ka.top().prompt = a), R;
            },
            get_prompt: function() {
                return ka.top().prompt;
            },
            set_mask: function(a) {
                return la.mask(a), R;
            },
            get_output: function(b) {
                return b ? $ : a.map($, function(a) {
                    return "function" == typeof a[0] ? a[0]() : a[0];
                }).join("\n");
            },
            resize: function(a, b) {
                a && b && (R.width(a), R.height(b)), a = R.width(), b = R.height();
                var c = r(R), d = s(R);
                return (c !== V || d !== W) && (V = c, W = d, z(), "function" != typeof da.onResize || Y === b && X === a || da.onResize(R), 
                (Y !== b || X !== a) && (Y = b, X = a)), R;
            },
            flush: function() {
                try {
                    var b;
                    if (a.each(M, function(c, d) {
                        if (d === Q) b = a("<div></div>"); else if ("function" == typeof d) {
                            b.appendTo(U);
                            try {
                                d(b);
                            } catch (e) {
                                v(e, "USER:echo(finalize)");
                            }
                        } else a("<div/>").html(d).appendTo(b).width("100%");
                    }), da.outputLimit >= 0) {
                        var c = 0 === da.outputLimit ? R.rows() : da.outputLimit, d = U.find("div div");
                        if (d.length > c) {
                            var e = d.slice(0, $.length - c + 1), f = e.parent();
                            e.remove(), f.each(function() {
                                var b = a(this);
                                b.is(":empty") && b.remove();
                            });
                        }
                    }
                    w(), M = [];
                } catch (g) {
                    alert("[Flush] " + q(g) + "\n" + g.stack);
                }
                return R;
            },
            echo: function(b, c) {
                try {
                    b = b || "";
                    var d = a.extend({
                        flush: !0,
                        raw: !1,
                        finalize: a.noop
                    }, c || {});
                    M = [], y(b, d), $.push([ b, d ]), d.flush && R.flush(), ha();
                } catch (e) {
                    alert("[Terminal.echo] " + q(e) + "\n" + e.stack);
                }
                return R;
            },
            error: function(b, c) {
                return R.echo("[[;#f00;]" + a.terminal.escape_brackets(b).replace(/\\$/, "&#92;") + "]", c);
            },
            exception: function(b, c) {
                var d = q(b);
                c && (d = "&#91;" + c + "&#93;: " + d), d && R.error(d, {
                    finalize: function(a) {
                        a.addClass("exception message");
                    }
                }), "string" == typeof b.fileName && (R.pause(), a.get(b.fileName, function(a) {
                    R.resume();
                    var c = b.lineNumber - 1, d = a.split("\n")[c];
                    d && R.error("&#91;" + b.lineNumber + "&#93;: " + d);
                })), b.stack && R.error(b.stack, {
                    finalize: function(a) {
                        a.addClass("exception stack-trace");
                    }
                });
            },
            scroll: function(a) {
                var b;
                return a = Math.round(a), S.prop ? (a > S.prop("scrollTop") && a > 0 && S.prop("scrollTop", 0), 
                b = S.prop("scrollTop"), S.scrollTop(b + a)) : (a > S.attr("scrollTop") && a > 0 && S.attr("scrollTop", 0), 
                b = S.attr("scrollTop"), S.scrollTop(b + a)), R;
            },
            logout: da.login ? function() {
                for (;ka.size() > 1; ) R.pop();
                return R.pop();
            } : function() {
                R.error(ea.loginFunctionMissing);
            },
            token: da.login ? function(b) {
                return a.Storage.get(R.prefix_name(b) + "_token");
            } : a.noop,
            login_name: da.login ? function(b) {
                return a.Storage.get(R.prefix_name(b) + "_login");
            } : a.noop,
            name: function() {
                return ka.top().name;
            },
            prefix_name: function(a) {
                var b = (da.name ? da.name + "_" : "") + _;
                return a && ka.size() > 1 && (b += "_" + ka.map(function(a) {
                    return a.name;
                }).slice(1).join("_")), b;
            },
            push: function(b, c) {
                c = c || {}, c.name = c.name || T, c.prompt = c.prompt || c.name + " ";
                var d = ka.top();
                return d && (d.mask = la.mask()), m(b, c.login, function(d) {
                    if (ka.push(a.extend({}, d, c)), c.login) {
                        var e = a.type(c.login);
                        "function" == e ? R.login(c.login, !1, G, R.pop) : ("string" == a.type(b) && "string" == e || "boolean" == e) && R.login(n(b, c.login), !1, G, R.pop);
                    } else G();
                }), R;
            },
            pop: function(c) {
                c !== b && B(c);
                var d = R.token(!0);
                if (1 == ka.size()) if (da.login) {
                    if (D(), "function" === a.type(da.onExit)) try {
                        da.onExit(R);
                    } catch (e) {
                        throw v(e, "onExit"), e;
                    }
                } else R.error(ea.canExitError); else {
                    d && E();
                    var f = ka.pop();
                    if (G(), "function" === a.type(f.onExit)) try {
                        f.onExit(R);
                    } catch (e) {
                        throw v(e, "onExit"), e;
                    }
                    R.set_mask(ka.top().mask);
                }
                return R;
            },
            level: function() {
                return ka.size();
            },
            reset: function() {
                for (R.clear(); ka.size() > 1; ) ka.pop();
                return H(), R;
            },
            purge: function() {
                var b = R.prefix_name() + "_", c = a.Storage.get(b + "interpreters");
                return a.each(a.parseJSON(c), function(b, c) {
                    a.Storage.remove(c + "_commands"), a.Storage.remove(c + "_token"), a.Storage.remove(c + "_login");
                }), la.purge(), a.Storage.remove(b + "interpreters"), R;
            },
            destroy: function() {
                return la.destroy().remove(), U.remove(), a(document).unbind(".terminal"), a(window).unbind(".terminal"), 
                R.unbind("click, mousewheel"), R.removeData("terminal").removeClass("terminal"), 
                da.width && R.css("width", ""), da.height && R.css("height", ""), R;
            }
        }, function(a, b) {
            return function() {
                try {
                    return b.apply(this, Array.prototype.slice.apply(arguments));
                } catch (c) {
                    throw "exec" !== a && "resume" !== a && v(c, "TERMINAL"), c;
                }
            };
        }));
        var ha = function() {
            var a = u(R);
            return function() {
                a !== u(R) && (R.resize(), a = u(R));
            };
        }();
        if (da.width && R.width(da.width), da.height && R.height(da.height), S = navigator.userAgent.toLowerCase().match(/(webkit)[ \/]([\w.]+)/) || "body" != R[0].tagName.toLowerCase() ? R : a("html"), 
        a(document).bind("ajaxSend.terminal", function(a, b, c) {
            O.push(b);
        }), U = a("<div>").addClass("terminal-output").appendTo(R), R.addClass("terminal"), 
        ("ontouchstart" in window || window.DocumentTouch && document instanceof DocumentTouch) && (R.click(function() {
            R.find("textarea").focus();
        }), R.find("textarea").focus()), da.login && "function" == typeof da.onBeforeLogin) try {
            da.onBeforeLogin(R);
        } catch (ia) {
            throw v(ia, "onBeforeLogin"), ia;
        }
        var ja = da.login;
        "string" != typeof c || "string" != typeof da.login && !da.login || (da.login = n(c, da.login)), 
        P.append(R);
        var ka, la;
        return m(c, ja, function(c) {
            if (ka = new k(a.extend({
                name: da.name,
                prompt: da.prompt,
                greetings: da.greetings
            }, c)), la = a("<div/>").appendTo(R).cmd({
                prompt: da.prompt,
                history: da.history,
                historyFilter: da.historyFilter,
                historySize: da.historySize,
                width: "100%",
                keydown: L,
                keypress: da.keypress ? function(a) {
                    return da.keypress(a, R);
                } : null,
                onCommandChange: function(b) {
                    if ("function" === a.type(da.onCommandChange)) try {
                        da.onCommandChange(b, R);
                    } catch (c) {
                        throw v(c, "onCommandChange"), c;
                    }
                    w();
                },
                commands: C
            }), fa ? R.focus(b, !0) : R.disable(), a(document).bind("click.terminal", function(b) {
                a(b.target).closest(".terminal").hasClass("terminal") || da.onBlur(R) === !1 || R.disable();
            }), R.click(function(a) {
                R.enabled() || R.focus();
            }).mousedown(function(a) {
                2 == a.which && R.insert(t());
            }), da.login ? R.login(da.login, !0, H) : H(), R.is(":visible") && (V = r(R), la.resize(V), 
            W = s(R)), R.oneTime(100, function() {
                a(window).bind("resize.terminal", function() {
                    if (R.is(":visible")) {
                        var a = R.width(), b = R.height();
                        (Y !== b || X !== a) && R.resize();
                    }
                });
            }), a.event.special.mousewheel) {
                var d = !1;
                a(document).bind("keydown.terminal", function(a) {
                    a.shiftKey && (d = !0);
                }).bind("keyup.terminal", function(a) {
                    (a.shiftKey || 16 == a.which) && (d = !1);
                }), R.mousewheel(function(a, b) {
                    d || (b > 0 ? R.scroll(-40) : R.scroll(40));
                });
            }
        }), R.data("terminal", R), R;
    };
}(jQuery), function() {
    app.ActiveDoc = function(a) {
        var b = this;
        b.name = ko.observable(a.name), b.maxWidth = ko.observable(800), b.totalHeight = ko.observable(1e3), 
        b.pages = ko.observableArray([]), b.updateFromData = function(a, c) {
            if (null == a) b.name(""), b.pages.removeAll(), b.maxWidth(0), b.totalHeight(0); else {
                b.name(a.name), b.pages.removeAll();
                var d = 0, e = 0;
                _.sortBy(a.page_infos, "number"), a.page_infos.forEach(function(a) {
                    d < a.width && (d = a.width), e += a.height + app.data.settings.pageVertMargin;
                });
                var f = app.data.settings.pageTopOffset;
                a.page_infos.forEach(function(a) {
                    var c = (d - a.width) / 2;
                    docPage = new app.DocPage({
                        x: c,
                        y: f,
                        width: a.width,
                        height: a.height,
                        number: a.number
                    }), b.pages.push(docPage), f += a.height;
                }), b.maxWidth(d), b.totalHeight(e), setTimeout(function() {
                    a.elements.forEach(function(a, c) {
                        var d = d3.select("#doc-page-" + a.features.page), e = (b.pages()[a.features.page - 1], 
                        (parseInt(a.features.page) - 1) * app.data.settings.pageVertMargin), f = a.features.x, g = a.features.y + e, h = "auto";
                        "undefined" != typeof a.features.size && (h = a.features.size + "px"), d.append("text").attr("class", "doc-element").attr("x", f).attr("y", g).attr("real-y", a.features.y).style("font-size", h).text(a.text);
                    }), d3.select("#doc-blocks").remove();
                    var d = d3.select("#doc-content").append("g").attr("id", "doc-blocks").attr("class", "doc-blocks");
                    if (null != c) for (var e = 0; e < c.length; e++) if (block = c[e], !(isNaN(block.x) || isNaN(block.y) || isNaN(block.x1) || isNaN(block.y1))) {
                        var f = 0;
                        block.page && (f = (parseInt(block.page) - 1) * app.data.settings.pageVertMargin), 
                        d.append("rect").attr("x", block.x).attr("y", block.y + f - app.data.settings.blockOffset).attr("width", block.x1 - block.x).attr("height", block.y1 - block.y).attr("title", "text: " + block.text + "\nx: " + block.x + "\nx1:" + block.x1 + "\ny: " + block.y + "\ny1:" + block.y1).on("mouseover", b.blockHover).on("mouseout", b.blockOut).on("click", b.blockClick).style("fill", "#CC0066").style("stroke", "#CC0066");
                    }
                }, 100);
            }
        }, b.blockHover = function() {
            d3.select(d3.event.target).style("fill", "#FFFFA3"), app.helpers.view.showTip();
        }, b.blockOut = function() {
            d3.select(d3.event.target).style("fill", "#CC0066"), app.helpers.view.hideTip();
        }, b.blockClick = function() {
            app.helpers.view.showBlockDialog();
        }, b.updateFromData(a, a.data_fields);
    };
}(), function() {
    app.DocPage = function(a) {
        var b = this;
        b.width = ko.observable(a.width), b.height = ko.observable(a.height), b.number = ko.observable(a.number), 
        b.x = ko.observable(a.x), b.xRender = ko.computed(function() {
            return b.x();
        }, this), b.y = ko.observable(a.y), b.yRender = ko.computed(function() {
            return this.y() + (this.number() - 1) * app.data.settings.pageVertMargin;
        }, this);
    };
}(), function() {
    app.Project = function(a) {
        var b = this;
        b.name = ko.observable(a.name), b.updateFromData = function(a) {
            b.name(a.name);
        };
    };
}();